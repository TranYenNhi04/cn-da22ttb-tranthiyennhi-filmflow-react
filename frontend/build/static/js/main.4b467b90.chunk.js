(this["webpackJsonphe-thong-goi-y-phim"]=this["webpackJsonphe-thong-goi-y-phim"]||[]).push([[0],[,,,function(e,t,a){e.exports={movieCardSkeleton:"RecommendationsPage_movieCardSkeleton__8Tpp6",pulse:"RecommendationsPage_pulse__1kNSZ",skeletonPoster:"RecommendationsPage_skeletonPoster__3Cj3U",shimmer:"RecommendationsPage_shimmer__1SWqD",skeletonText:"RecommendationsPage_skeletonText__2Y7r9",skeletonTitle:"RecommendationsPage_skeletonTitle__3Xh6g",mainContent:"RecommendationsPage_mainContent__2ukib",header:"RecommendationsPage_header__2C1py",fadeInDown:"RecommendationsPage_fadeInDown__4AfRy",pageHeader:"RecommendationsPage_pageHeader__1dGp3",controlToggleBtn:"RecommendationsPage_controlToggleBtn__1o6Dm",cardBox:"RecommendationsPage_cardBox__acd2p",recommendationForm:"RecommendationsPage_recommendationForm__1dOwL",fadeInUp:"RecommendationsPage_fadeInUp__6YdLT",formGroup:"RecommendationsPage_formGroup__QfDFH",btn:"RecommendationsPage_btn__2JLs2",error:"RecommendationsPage_error__2hViY",shake:"RecommendationsPage_shake__23p4p",loading:"RecommendationsPage_loading__17NNa",rowTitle:"RecommendationsPage_rowTitle__2Q5T2",movieRow:"RecommendationsPage_movieRow__1ao_G",movieCard:"RecommendationsPage_movieCard__2O0fh",moviePosterContainer:"RecommendationsPage_moviePosterContainer__26cQV",moviePoster:"RecommendationsPage_moviePoster__I1su5",moviePosterPlaceholder:"RecommendationsPage_moviePosterPlaceholder___B3m3",movieDetails:"RecommendationsPage_movieDetails__1MbHH",movieTitle:"RecommendationsPage_movieTitle__1EUlM",rating:"RecommendationsPage_rating__3nzcA",overview:"RecommendationsPage_overview__17bGE",trailerBtn:"RecommendationsPage_trailerBtn__vg_VA",playOverlay:"RecommendationsPage_playOverlay__P2Gq0",moviePlayerContainer:"RecommendationsPage_moviePlayerContainer__8HVnN",backButton:"RecommendationsPage_backButton__zzqjY",playerSection:"RecommendationsPage_playerSection__fgbGk",videoPlayer:"RecommendationsPage_videoPlayer__32Hya",progressIndicator:"RecommendationsPage_progressIndicator__eE9nG",progressInfo:"RecommendationsPage_progressInfo__1IlQs",progressPercentage:"RecommendationsPage_progressPercentage__16GOb",progressBar:"RecommendationsPage_progressBar__l867Q",progressFill:"RecommendationsPage_progressFill__c9JeS",noVideo:"RecommendationsPage_noVideo__2Gerw",noPoster:"RecommendationsPage_noPoster__3v5NZ",noVideoOverlay:"RecommendationsPage_noVideoOverlay__2J_eP",debugPanel:"RecommendationsPage_debugPanel__1H-rJ",movieInfo:"RecommendationsPage_movieInfo__3aUQT",movieInfoTitle:"RecommendationsPage_movieInfoTitle__1R7Dy",movieMeta:"RecommendationsPage_movieMeta__1wGNb",movieRating:"RecommendationsPage_movieRating__3Hdnq",movieVotes:"RecommendationsPage_movieVotes__21Edf",movieDescription:"RecommendationsPage_movieDescription__KzMEY",similarMoviesSection:"RecommendationsPage_similarMoviesSection__1XvBO",sectionTitle:"RecommendationsPage_sectionTitle__opetD",loadingMovies:"RecommendationsPage_loadingMovies__1hSmg",similarMoviesGrid:"RecommendationsPage_similarMoviesGrid__1hAoN",movieCardCompact:"RecommendationsPage_movieCardCompact__xhnHL",interactionButtons:"RecommendationsPage_interactionButtons__3GjTL",likeBtn:"RecommendationsPage_likeBtn__2J8MX",dislikeBtn:"RecommendationsPage_dislikeBtn__1Y_IJ",watchlistBtn:"RecommendationsPage_watchlistBtn__2df6b",reviewBtn:"RecommendationsPage_reviewBtn__gPbMf",active:"RecommendationsPage_active__3Btxd",modalOverlay:"RecommendationsPage_modalOverlay__3YzjP",fadeIn:"RecommendationsPage_fadeIn__1wBty",modalContent:"RecommendationsPage_modalContent__gruYo",slideUp:"RecommendationsPage_slideUp__3PtmG",modalHeader:"RecommendationsPage_modalHeader__1APJZ",closeBtn:"RecommendationsPage_closeBtn__TZUIw",modalBody:"RecommendationsPage_modalBody__1dPlY",ratingGroup:"RecommendationsPage_ratingGroup__at10X",ratingStars:"RecommendationsPage_ratingStars__31gE-",star:"RecommendationsPage_star__2DGs-",starActive:"RecommendationsPage_starActive__2o6s3",starPulse:"RecommendationsPage_starPulse__3AXDY",ratingInline:"RecommendationsPage_ratingInline__3FaHZ",reviewGroup:"RecommendationsPage_reviewGroup__1nr9j",usernameInput:"RecommendationsPage_usernameInput__1rjzU",reviewInput:"RecommendationsPage_reviewInput__1rNna",commentsSection:"RecommendationsPage_commentsSection__2G_jO",commentForm:"RecommendationsPage_commentForm__HntYb",submitBtn:"RecommendationsPage_submitBtn__1JGac",commentList:"RecommendationsPage_commentList__1HF-R",commentItem:"RecommendationsPage_commentItem__2iDIL",commentMeta:"RecommendationsPage_commentMeta__9WMwJ",commentTime:"RecommendationsPage_commentTime__2N8xb",commentText:"RecommendationsPage_commentText__1161K",commentToggle:"RecommendationsPage_commentToggle__UZsHQ",smallBtn:"RecommendationsPage_smallBtn__3Xs17",comments:"RecommendationsPage_comments__lUOMi",modalFooter:"RecommendationsPage_modalFooter__1ggV4",cancelBtn:"RecommendationsPage_cancelBtn__OTDXD"}},function(e,t,a){e.exports={authPage:"AuthPage_authPage__3o3xY",authBackground:"AuthPage_authBackground__lmcrp",authHeader:"AuthPage_authHeader__dEBYI",fadeInDown:"AuthPage_fadeInDown__29uR-",logo:"AuthPage_logo__1D21v",authContainer:"AuthPage_authContainer__1RkOM",fadeInUp:"AuthPage_fadeInUp__1ROTK",authBox:"AuthPage_authBox__1NQwv",authTitle:"AuthPage_authTitle__2xiIl",error:"AuthPage_error__17fMh",shake:"AuthPage_shake__1_GTS",authForm:"AuthPage_authForm__2VHjr",inputGroup:"AuthPage_inputGroup__3YnpI",input:"AuthPage_input__22hfS",submitBtn:"AuthPage_submitBtn__3cBZ0",switchText:"AuthPage_switchText__2zMKk",switchBtn:"AuthPage_switchBtn__sk5tZ"}},,,,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var c=a(1),s=a.n(c),n=a(6),o=a.n(n),i=(a(11),a(2)),l=a(4),r=a.n(l);const d="http://localhost:8000";var m=a(0);function h(e){let{onLogin:t}=e;const[a,s]=Object(c.useState)(!0),[n,o]=Object(c.useState)({email:"",password:"",name:""}),[l,h]=Object(c.useState)(""),j=e=>{o(Object(i.a)(Object(i.a)({},n),{},{[e.target.name]:e.target.value}))};return Object(m.jsxs)("div",{className:r.a.authPage,children:[Object(m.jsx)("div",{className:r.a.authBackground}),Object(m.jsx)("div",{className:r.a.authHeader,children:Object(m.jsx)("h1",{className:r.a.logo,children:"FilmFlow"})}),Object(m.jsx)("div",{className:r.a.authContainer,children:Object(m.jsxs)("div",{className:r.a.authBox,children:[Object(m.jsx)("h2",{className:r.a.authTitle,children:a?"\u0110\u0103ng nh\u1eadp":"\u0110\u0103ng k\xfd"}),l&&Object(m.jsx)("div",{className:r.a.error,children:l}),Object(m.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),h(""),n.email&&n.password)if(a||n.name)if(a)fetch("".concat(d,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.email,password:n.password})}).then(async a=>{if(200===a.status){const s=await a.json();let o={userId:s.user.id};try{var c;const e=JSON.parse(s.user.metadata||"{}");o.email=e.email||n.email,o.name=e.name||(null===(c=e.email)||void 0===c?void 0:c.split("@")[0])||n.email.split("@")[0]||"User"}catch(e){o.email=n.email,o.name=n.name||n.email.split("@")[0]||"User"}localStorage.setItem("user",JSON.stringify(o)),t()}else 404===a.status?(h("T\xe0i kho\u1ea3n ch\u01b0a t\u1ed3n t\u1ea1i. Vui l\xf2ng \u0111\u0103ng k\xfd."),s(!1)):h("L\u1ed7i \u0111\u0103ng nh\u1eadp. Vui l\xf2ng th\u1eed l\u1ea1i.")}).catch(()=>{h("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn server. Vui l\xf2ng th\u1eed l\u1ea1i sau.")});else{let e={userId:"user_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,9)),email:n.email,name:n.name||n.email.split("@")[0]||"User"};fetch("".concat(d,"/users"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.userId,metadata:JSON.stringify({name:e.name,email:e.email})})}).catch(()=>{}),localStorage.setItem("user",JSON.stringify(e)),t()}else h("Vui l\xf2ng nh\u1eadp t\xean c\u1ee7a b\u1ea1n");else h("Vui l\xf2ng \u0111i\u1ec1n \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin")},className:r.a.authForm,children:[!a&&Object(m.jsx)("div",{className:r.a.inputGroup,children:Object(m.jsx)("input",{type:"text",name:"name",placeholder:"T\xean c\u1ee7a b\u1ea1n",value:n.name,onChange:j,className:r.a.input})}),Object(m.jsx)("div",{className:r.a.inputGroup,children:Object(m.jsx)("input",{type:"email",name:"email",placeholder:"Email ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",value:n.email,onChange:j,className:r.a.input})}),Object(m.jsx)("div",{className:r.a.inputGroup,children:Object(m.jsx)("input",{type:"password",name:"password",placeholder:"M\u1eadt kh\u1ea9u",value:n.password,onChange:j,className:r.a.input})}),Object(m.jsx)("button",{type:"submit",className:r.a.submitBtn,children:a?"\u0110\u0103ng nh\u1eadp":"\u0110\u0103ng k\xfd"})]}),Object(m.jsxs)("div",{className:r.a.authFooter,children:[Object(m.jsx)("span",{className:r.a.switchText,children:a?"B\u1ea1n m\u1edbi s\u1eed d\u1ee5ng FilmFlow?":"\u0110\xe3 c\xf3 t\xe0i kho\u1ea3n?"}),Object(m.jsx)("button",{onClick:()=>s(!a),className:r.a.switchBtn,children:a?"\u0110\u0103ng k\xfd ngay":"\u0110\u0103ng nh\u1eadp ngay"})]})]})})]})}a(13),a(14);function j(){return Object(m.jsxs)("div",{className:"movie-card-skeleton",children:[Object(m.jsx)("div",{className:"skeleton-thumb"}),Object(m.jsxs)("div",{className:"skeleton-info",children:[Object(m.jsx)("div",{className:"skeleton-title"}),Object(m.jsx)("div",{className:"skeleton-meta"})]})]})}function u(e){let{count:t=12}=e;return Object(m.jsx)("div",{className:"movie-grid",children:Array.from({length:t}).map((e,t)=>Object(m.jsx)(j,{},t))})}function b(e){let{movie:t,commentCounts:a,onClick:c}=e;const s=t.poster_url||t.poster_path||t.poster;return Object(m.jsx)("div",{className:"movie-card",onClick:()=>c&&c(t),children:Object(m.jsxs)("div",{className:"movie-thumb",children:[s?Object(m.jsx)("img",{src:s,alt:t.title,loading:"lazy",decoding:"async",onError:e=>{e.target.onerror=null,e.target.src="https://picsum.photos/seed/".concat(t.id||t.title,"/300/450")}}):Object(m.jsx)("div",{className:"no-poster",children:"Kh\xf4ng c\xf3 poster"}),Object(m.jsx)("div",{className:"movie-overlay",children:Object(m.jsxs)("div",{className:"overlay-content",children:[Object(m.jsx)("h3",{className:"movie-title",children:t.title}),Object(m.jsxs)("div",{className:"movie-meta",children:[Object(m.jsx)("span",{className:"year",children:t.year}),Object(m.jsxs)("span",{className:"rating",children:["\u2b50 ",t.vote_average||"N/A"]}),Object(m.jsxs)("span",{className:"comments",children:["\ud83d\udcac ",a&&(a[t.id]||0)]})]}),Object(m.jsx)("div",{className:"movie-actions",children:Object(m.jsx)("button",{className:"btn-play",onClick:e=>{e.stopPropagation(),c&&c(t)},children:"\u25b6 Xem phim"})})]})})]})})}function g(e){let{onMovieClick:t}=e;const[a,s]=Object(c.useState)([]),[n,o]=Object(c.useState)({}),[l,r]=Object(c.useState)([]),[h,j]=Object(c.useState)([]),[g,v]=Object(c.useState)([]),[O,p]=Object(c.useState)([]),[_,f]=Object(c.useState)([]),[x,N]=Object(c.useState)([]),[y,S]=Object(c.useState)(!1),[w,I]=Object(c.useState)({trending:!0,featured:!0,topRated:!0,new:!0}),[k,P]=Object(c.useState)(""),[C,T]=Object(c.useState)([]),[R,J]=Object(c.useState)(!1),B=Object(c.useRef)(null),[F,A]=Object(c.useState)("all"),[M,D]=Object(c.useState)("all"),[E,L]=Object(c.useState)("rating"),G=async e=>{try{const t=e.map(e=>e.id).filter(Boolean);if(!t.length)return;const a=await fetch("".concat(d,"/movies/comments/counts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({movie_ids:t})});if(a.ok){const e=await a.json(),t=e.counts||e||{};o(e=>Object(i.a)(Object(i.a)({},e),t))}}catch(t){console.error("Failed to fetch comment counts:",t)}},H={action:["action","h\xe0nh \u0111\u1ed9ng"],comedy:["comedy","h\xe0i"],drama:["drama","ch\xednh k\u1ecbch"],horror:["horror","kinh d\u1ecb"],romance:["romance","l\xe3ng m\u1ea1n"]},K=e=>{let t=[...e];if("all"!==F){const e=H[F.toLowerCase()]||[F.toLowerCase()];t=t.filter(t=>{try{let a=t.genres;if("string"===typeof a&&(a=JSON.parse(a)),Array.isArray(a)){return a.map(e=>"string"===typeof e?e.toLowerCase():e.name?e.name.toLowerCase():"").some(t=>e.some(e=>t.includes(e)||e.includes(t)))}return!1}catch(a){return console.warn("Genre parse error:",a),!1}})}return"all"!==M&&("2024"===M?t=t.filter(e=>e.year>=2024):"2023"===M?t=t.filter(e=>2023===e.year):"2020-2022"===M?t=t.filter(e=>e.year>=2020&&e.year<=2022):"older"===M&&(t=t.filter(e=>e.year<2020))),"rating"===E?t.sort((e,t)=>(t.vote_average||0)-(e.vote_average||0)):"newest"===E?t.sort((e,t)=>(t.year||0)-(e.year||0)):"title"===E&&t.sort((e,t)=>(e.title||"").localeCompare(t.title||"")),t};return Object(c.useEffect)(()=>{(async()=>{var e;const t=localStorage.getItem("user"),a=t?null===(e=JSON.parse(t))||void 0===e?void 0:e.userId:null;try{if(a){const e=localStorage.getItem("watchlist_".concat(a));if(e)try{const t=JSON.parse(e);Array.isArray(t)&&setWatchlist(t)}catch(c){}}const e=localStorage.getItem("cached_trending");if(e)try{const t=JSON.parse(e);t.movies&&t.movies.length>0&&(p(t.movies),f(t.movies.slice(0,20)),I(e=>Object(i.a)(Object(i.a)({},e),{},{trending:!1})))}catch(c){}const t="cached_recs_collaborative_".concat(a||"public"),n=localStorage.getItem(t);if(n)try{const e=JSON.parse(n).results||[];if(e.length>0){const t=e.filter(e=>e.vote_average>=7).slice(0,6);r(t),s(e),v([...e].sort((e,t)=>(t.vote_average||0)-(e.vote_average||0)).slice(0,12)),I(e=>Object(i.a)(Object(i.a)({},e),{},{featured:!1,topRated:!1}))}}catch(c){}const o=localStorage.getItem("cached_new_releases");if(o)try{const e=JSON.parse(o);e.movies&&e.movies.length>0&&(j(e.movies),I(e=>Object(i.a)(Object(i.a)({},e),{},{new:!1})))}catch(c){}}catch(c){console.warn("Cache load failed:",c)}try{fetch("".concat(d,"/movies/trending?limit=12")).then(e=>e.ok?e.json():null).then(e=>{if(e&&e.movies){const t=e.movies;p(t),f(t.slice(0,20)),I(e=>Object(i.a)(Object(i.a)({},e),{},{trending:!1}));try{localStorage.setItem("cached_trending",JSON.stringify({movies:t,ts:Date.now()}))}catch(c){}t.length>0&&G(t)}}).catch(e=>{console.error("Trending fetch failed:",e),I(e=>Object(i.a)(Object(i.a)({},e),{},{trending:!1}))}),I(e=>Object(i.a)(Object(i.a)({},e),{},{featured:!0,topRated:!0})),fetch("".concat(d,"/recommendations?rec_type=collaborative&n=50")).then(e=>e.ok?e.json():(I(e=>Object(i.a)(Object(i.a)({},e),{},{featured:!1,topRated:!1})),null)).then(e=>{if(e){const t=e.results||[],a=new Set(O.map(e=>e.id)),c=t.filter(e=>!a.has(e.id)),n=c.filter(e=>e.vote_average>=7).slice(0,6),o=new Set(n.map(e=>e.id)),l=[...c].filter(e=>!o.has(e.id)).sort((e,t)=>(t.vote_average||0)-(e.vote_average||0)).slice(0,12);r(n),s(c.slice(0,12)),v(l),I(e=>Object(i.a)(Object(i.a)({},e),{},{featured:!1,topRated:!1})),localStorage.setItem(cacheKey,JSON.stringify({results:c})),G([...n,...l])}}).catch(e=>{console.warn("Recommendations fetch failed:",e),I(e=>Object(i.a)(Object(i.a)({},e),{},{featured:!1,topRated:!1}))})}catch(c){console.warn("Priority fetch failed:",c)}if(a)try{const[e,t]=await Promise.all([fetch("".concat(d,"/watch-history/").concat(a)),fetch("".concat(d,"/watchlist/").concat(a))]);if(e.ok){const t=await e.json(),a=t.movies||t.history||[],c=[],s=new Set;a.forEach(e=>{s.has(e.movieId)||(s.add(e.movieId),c.push(e))}),N(c)}if(t.ok){const e=await t.json(),s=e.movies||e.watchlist||[];setWatchlist(s);try{localStorage.setItem("watchlist_".concat(a),JSON.stringify(s))}catch(c){console.warn("Failed to cache watchlist:",c)}}}catch(c){console.warn("Failed to fetch user data:",c)}fetch("".concat(d,"/movies/new-releases?limit=30")).then(e=>e.ok?e.json():null).then(e=>{if(e){const t=e.movies||[];j(t),I(e=>Object(i.a)(Object(i.a)({},e),{},{new:!1}));try{localStorage.setItem("cached_new_releases",JSON.stringify({movies:t,ts:Date.now()}))}catch(c){}t.length>0&&G(t)}}).catch(e=>{console.warn("Failed to fetch new releases:",e),I(e=>Object(i.a)(Object(i.a)({},e),{},{new:!1}))})})()},[]),Object(m.jsxs)("div",{className:"home-page",children:[Object(m.jsxs)("section",{className:"hero-section",children:[Object(m.jsxs)("div",{className:"hero-background",children:[Object(m.jsx)("div",{className:"hero-posters-grid",children:_.length>0?_.map((e,t)=>Object(m.jsx)("div",{className:"hero-poster-item",style:{animationDelay:"".concat(.1*t,"s")},children:Object(m.jsx)("img",{src:e.poster_url||e.poster_path||"https://picsum.photos/seed/".concat(e.id,"/300/450"),alt:e.title,loading:"lazy"})},t)):Array.from({length:20}).map((e,t)=>Object(m.jsx)("div",{className:"hero-poster-item placeholder",style:{animationDelay:"".concat(.1*t,"s")}},t))}),Object(m.jsx)("div",{className:"hero-gradient-overlay"})]}),Object(m.jsxs)("div",{className:"hero-overlay",children:[Object(m.jsxs)("h1",{className:"hero-title",children:[Object(m.jsx)("span",{className:"hero-title-main",children:"Kh\xe1m ph\xe1 th\u1ebf gi\u1edbi \u0111i\u1ec7n \u1ea3nh"}),Object(m.jsx)("span",{className:"hero-title-sub",children:"Kh\xf4ng gi\u1edbi h\u1ea1n"})]}),Object(m.jsx)("p",{className:"hero-subtitle",children:"H\xe0ng ngh\xecn b\u1ed9 phim, series hot \u0111ang ch\u1edd b\u1ea1n"}),Object(m.jsx)("p",{className:"hero-description",children:"Ch\u1ea5t l\u01b0\u1ee3ng HD/4K cao c\u1ea5p \u2022 C\u1eadp nh\u1eadt li\xean t\u1ee5c m\u1ed7i ng\xe0y \u2022 Xem m\u1ecdi l\xfac m\u1ecdi n\u01a1i"}),Object(m.jsxs)("div",{className:"search-container",children:[Object(m.jsx)("input",{type:"text",className:"search-input",placeholder:"T\xecm ki\u1ebfm phim, di\u1ec5n vi\xean, \u0111\u1ea1o di\u1ec5n...",value:k,onChange:e=>(async t=>{if(P(t),B.current&&clearTimeout(B.current),t.trim().length>0){const a="search_".concat(t.toLowerCase().trim()),c=localStorage.getItem(a);if(c)try{const e=JSON.parse(c);if(Date.now()-e.timestamp<3e5)return T(e.results||[]),void J(!0)}catch(e){}B.current=setTimeout(async()=>{J(!0);try{var c;const s=localStorage.getItem("user"),n=s?null===(c=JSON.parse(s))||void 0===c?void 0:c.userId:null,o=n?"&user_id=".concat(encodeURIComponent(n)):"",i=await fetch("".concat(d,"/movies/autocomplete?q=").concat(encodeURIComponent(t),"&n=20").concat(o));if(i.ok){const t=(await i.json()).results||[];T(t);try{localStorage.setItem(a,JSON.stringify({results:t,timestamp:Date.now()}))}catch(e){}}else T([])}catch(s){console.error("Search failed:",s),T([])}},150)}else J(!1),T([])})(e.target.value)}),Object(m.jsx)("button",{className:"search-btn",children:"T\xecm ki\u1ebfm"})]})]})]}),!R&&Object(m.jsxs)("div",{className:"filter-bar",children:[Object(m.jsx)("div",{className:"filter-group",children:Object(m.jsxs)("select",{value:F,onChange:e=>A(e.target.value),className:"filter-select",children:[Object(m.jsx)("option",{value:"all",children:"T\u1ea5t c\u1ea3 th\u1ec3 lo\u1ea1i"}),Object(m.jsx)("option",{value:"action",children:"H\xe0nh \u0111\u1ed9ng"}),Object(m.jsx)("option",{value:"comedy",children:"H\xe0i"}),Object(m.jsx)("option",{value:"drama",children:"Ch\xednh k\u1ecbch"}),Object(m.jsx)("option",{value:"horror",children:"Kinh d\u1ecb"}),Object(m.jsx)("option",{value:"romance",children:"L\xe3ng m\u1ea1n"})]})}),Object(m.jsx)("div",{className:"filter-group",children:Object(m.jsxs)("select",{value:M,onChange:e=>D(e.target.value),className:"filter-select",children:[Object(m.jsx)("option",{value:"all",children:"T\u1ea5t c\u1ea3 n\u0103m"}),Object(m.jsx)("option",{value:"2024",children:"2024"}),Object(m.jsx)("option",{value:"2023",children:"2023"}),Object(m.jsx)("option",{value:"2020-2022",children:"2020-2022"}),Object(m.jsx)("option",{value:"older",children:"Tr\u01b0\u1edbc 2020"})]})}),Object(m.jsx)("div",{className:"filter-group",children:Object(m.jsxs)("select",{value:E,onChange:e=>L(e.target.value),className:"filter-select",children:[Object(m.jsx)("option",{value:"rating",children:"\u0110\xe1nh gi\xe1 cao"}),Object(m.jsx)("option",{value:"newest",children:"M\u1edbi nh\u1ea5t"}),Object(m.jsx)("option",{value:"title",children:"T\xean A-Z"})]})})]}),R&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsxs)("h2",{className:"section-title",children:['\ud83d\udd0e K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm "',k,'"']})}),C.length>0?Object(m.jsx)("div",{className:"movie-grid",children:C.map((e,a)=>Object(m.jsx)(b,{movie:e,commentCounts:n,onClick:t},a))}):Object(m.jsx)("div",{className:"no-results",children:"Kh\xf4ng t\xecm th\u1ea5y phim"})]}),!R&&x.length>0&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsx)("h2",{className:"section-title",children:"\ud83d\udcfa Ti\u1ebfp t\u1ee5c xem"})}),Object(m.jsx)("div",{className:"movie-grid",children:x.slice(0,12).map(e=>{const c=a.find(t=>t.id===e.movieId);return c?Object(m.jsx)(b,{movie:c,commentCounts:n,onClick:t},e.movieId):null})})]}),!R&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsx)("h2",{className:"section-title",children:"\ud83d\udd25 \u0110ang Hot Nh\u1ea5t"})}),w.trending?Object(m.jsx)(u,{count:12}):0===O.length?Object(m.jsx)("div",{className:"no-results",children:"Ch\u01b0a c\xf3 phim trending"}):(()=>{const e=K(O).slice(0,12);return e.length>0?Object(m.jsx)("div",{className:"movie-grid",children:e.map((e,a)=>Object(m.jsx)(b,{movie:e,commentCounts:n,onClick:t},a))}):Object(m.jsx)("div",{className:"no-results",children:"Kh\xf4ng t\xecm th\u1ea5y phim ph\xf9 h\u1ee3p v\u1edbi b\u1ed9 l\u1ecdc"})})()]}),!R&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsx)("h2",{className:"section-title",children:"\ud83c\udfaf G\u1ee3i \xdd D\xe0nh Ri\xeang Cho B\u1ea1n"})}),w.featured?Object(m.jsx)(u,{count:6}):0===l.length?Object(m.jsx)("div",{className:"no-results",children:"Ch\u01b0a c\xf3 g\u1ee3i \xfd"}):(()=>{const e=K(l);return e.length>0?Object(m.jsx)("div",{className:"movie-grid",children:e.map((e,a)=>Object(m.jsx)(b,{movie:e,commentCounts:n,onClick:t},a))}):Object(m.jsx)("div",{className:"no-results",children:"Kh\xf4ng t\xecm th\u1ea5y phim ph\xf9 h\u1ee3p v\u1edbi b\u1ed9 l\u1ecdc"})})()]}),!R&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsx)("h2",{className:"section-title",children:"\ud83c\udd95 Phim M\u1edbi C\u1eadp Nh\u1eadt"})}),w.new?Object(m.jsx)(u,{count:12}):0===h.length?Object(m.jsx)("div",{className:"no-results",children:"Ch\u01b0a c\xf3 phim m\u1edbi"}):(()=>{const e=K(h).slice(0,12);return e.length>0?Object(m.jsx)("div",{className:"movie-grid",children:e.map((e,a)=>Object(m.jsx)(b,{movie:e,commentCounts:n,onClick:t},a))}):Object(m.jsx)("div",{className:"no-results",children:"Kh\xf4ng t\xecm th\u1ea5y phim ph\xf9 h\u1ee3p v\u1edbi b\u1ed9 l\u1ecdc"})})()]}),!R&&Object(m.jsxs)("section",{className:"movie-section",children:[Object(m.jsx)("div",{className:"section-header",children:Object(m.jsx)("h2",{className:"section-title",children:"\u2b50 \u0110i\u1ec3m Cao Nh\u1ea5t"})}),w.topRated?Object(m.jsx)(u,{count:12}):0===g.length?Object(m.jsx)("div",{className:"no-results",children:"Ch\u01b0a c\xf3 phim"}):(()=>{const e=K(g).slice(0,12);return e.length>0?Object(m.jsx)("div",{className:"movie-grid",children:e.map((e,a)=>Object(m.jsx)(b,{movie:e,commentCounts:n,onClick:t},a))}):Object(m.jsx)("div",{className:"no-results",children:"Kh\xf4ng t\xecm th\u1ea5y phim ph\xf9 h\u1ee3p v\u1edbi b\u1ed9 l\u1ecdc"})})()]})]})}var v=a(3),O=a.n(v);function p(e){let{onBack:t,initialMovie:a}=e;const[n]=Object(c.useState)("hybrid"),[o,l]=Object(c.useState)([]),[r,h]=Object(c.useState)(!0),[j,u]=Object(c.useState)(""),[b,g]=Object(c.useState)([]),[v,p]=Object(c.useState)({}),[_,f]=Object(c.useState)({}),[x,N]=Object(c.useState)({}),[y,S]=Object(c.useState)({}),[w,I]=Object(c.useState)(0),[k,P]=Object(c.useState)([]),[C,T]=Object(c.useState)(""),[R,J]=Object(c.useState)(!1),[B,F]=Object(c.useState)(0),[A,M]=Object(c.useState)({}),[D,E]=Object(c.useState)(null),L=s.a.useRef(null),G=b.length>0?b[b.length-1]:null,H=G&&v[G.id]||[];Object(c.useEffect)(()=>{try{const e=localStorage.getItem("video_progress");e&&M(JSON.parse(e))}catch(e){console.warn("Failed to load video progress:",e)}},[]),Object(c.useEffect)(()=>{try{const e=localStorage.getItem("user"),t=e?JSON.parse(e):null;if(null!==t&&void 0!==t&&t.userId){const e="watchlist_".concat(t.userId),a=localStorage.getItem(e);if(a){const e=JSON.parse(a),t={};e.forEach(e=>{t[e.id]=!0}),S(t)}const c="likes_cache_".concat(t.userId),s=localStorage.getItem(c);if(s){const e=JSON.parse(s),t={},a={};Object.keys(e).forEach(c=>{const s=e[c];"like"===s?(t[c]=!0,a[c]=!1):"dislike"===s&&(a[c]=!0,t[c]=!1)}),f(t),N(a)}}}catch(e){console.warn("Failed to load user state:",e)}},[]),Object(c.useEffect)(()=>{if(a){const e=b.length>0?b[b.length-1]:null;e&&e.id===a.id||U(a)}},[a]);const K=async(e,t,a)=>{if(!e||null===t||void 0===t)return;const c=Object(i.a)(Object(i.a)({},A),{},{[e]:{timestamp:Math.floor(t),duration:Math.floor(a||0),savedAt:Date.now()}});M(c);try{localStorage.setItem("video_progress",JSON.stringify(c))}catch(s){console.warn("Failed to save progress to localStorage:",s)}try{const c=localStorage.getItem("user"),s=c?JSON.parse(c):null,n=(null===s||void 0===s?void 0:s.userId)||"Anonymous";await fetch("".concat(d,"/watch-history"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n,movie_id:e,timestamp:Math.floor(t),duration:Math.floor(a||0)})})}catch(s){console.warn("Failed to save progress to backend:",s)}},U=async e=>{console.debug("openMovie called for",e&&e.id,e&&e.title);const t="".concat(Date.now(),"-").concat(Math.floor(1e5*Math.random())),a=Object(i.a)(Object(i.a)({},e),{},{video_url:e.video_url||null,poster_url:e.poster_url||null,loadingTrailer:!e.video_url,historyId:t});g(e=>[...e,a]);try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null;a&&a.userId&&fetch("".concat(d,"/interactions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.userId,movieId:e.id,action:"view"})}).catch(()=>{})}catch(c){}try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null;if(a&&a.userId){try{const t="watchlist_".concat(a.userId),c=localStorage.getItem(t);if(c){const t=JSON.parse(c).some(t=>t.id===e.id);S(a=>Object(i.a)(Object(i.a)({},a),{},{[e.id]:t}))}}catch(c){console.warn("Failed to check watchlist status:",c)}try{const t="likes_cache_".concat(a.userId),c=localStorage.getItem(t);if(c){const t=JSON.parse(c);if(t&&t[e.id]){const a=t[e.id];return void("like"===a?(f(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!0})),N(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!1}))):"dislike"===a&&(N(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!0})),f(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!1}))))}}}catch(c){}fetch("".concat(d,"/interactions?user_id=").concat(encodeURIComponent(a.userId),"&movie_id=").concat(e.id,"&limit=1")).then(e=>e.ok?e.json():null).then(t=>{if(t&&t.results&&t.results.length>0){const s=t.results[0];if("like"===s.action){f(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!0})),N(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!1}));try{const t="likes_cache_".concat(a.userId),c=localStorage.getItem(t),s=c?JSON.parse(c):{};s[e.id]="like",localStorage.setItem(t,JSON.stringify(s))}catch(c){}}else if("dislike"===s.action){N(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!0})),f(t=>Object(i.a)(Object(i.a)({},t),{},{[e.id]:!1}));try{const t="likes_cache_".concat(a.userId),c=localStorage.getItem(t),s=c?JSON.parse(c):{};s[e.id]="dislike",localStorage.setItem(t,JSON.stringify(s))}catch(c){}}}}).catch(()=>{})}}catch(c){}if(!e.video_url){try{const a=await fetch("".concat(d,"/movies/").concat(e.id,"/trailer"));if(console.debug("trailer endpoint response status",a.status),a.ok){const e=await a.json();console.debug("trailer endpoint data",e),g(a=>a.map(a=>a.historyId===t?Object(i.a)(Object(i.a)({},a),{},{video_url:(null===e||void 0===e?void 0:e.video_url)||a.video_url,poster_url:(null===e||void 0===e?void 0:e.poster_url)||a.poster_url,loadingTrailer:!1}):a))}else g(e=>e.map(e=>e.historyId===t?Object(i.a)(Object(i.a)({},e),{},{loadingTrailer:!1}):e))}catch(s){console.error("Failed to fetch trailer endpoint:",s),g(e=>e.map(e=>e.historyId===t?Object(i.a)(Object(i.a)({},e),{},{loadingTrailer:!1}):e))}g(e=>e.map(e=>{if(e.historyId!==t)return e;if(e.video_url)return e;try{const t=e.title||"",a=e.year?" ".concat(e.year):"",c=encodeURIComponent("".concat(t).concat(a," trailer"));return Object(i.a)(Object(i.a)({},e),{},{video_url:"https://www.youtube.com/results?search_query=".concat(c)})}catch(c){return e}}))}v[e.id]||fetch("".concat(d,"/recommendations?rec_type=content&movie_id=").concat(e.id,"&n=10")).then(e=>e.ok?e.json():null).then(t=>{t&&t.results&&p(a=>Object(i.a)(Object(i.a)({},a),{},{[e.id]:t.results}))}).catch(e=>console.error("Failed to fetch similar movies:",e));try{fetch("".concat(d,"/movies/").concat(e.id,"/comments?limit=20")).then(e=>e.ok?e.json():null).then(e=>{e&&e.comments&&(P(e.comments),J(!1))}).catch(()=>{})}catch(c){}},Y=e=>{var t;let{movie:a,isCompact:c}=e;return Object(m.jsxs)("div",{className:c?O.a.movieCardCompact:O.a.movieCard,onClick:()=>U(a),children:[Object(m.jsxs)("div",{className:O.a.moviePosterContainer,children:[a.poster_url?Object(m.jsx)("img",{src:a.poster_url,alt:a.title,className:O.a.moviePoster,loading:"lazy"}):Object(m.jsx)("div",{className:O.a.moviePosterPlaceholder,children:Object(m.jsx)("p",{children:"Kh\xf4ng c\xf3 Poster"})}),Object(m.jsx)("div",{className:O.a.playOverlay,children:"\u25b6"})]}),Object(m.jsxs)("div",{className:O.a.movieDetails,children:[Object(m.jsxs)("h3",{className:O.a.movieTitle,children:[a.title," ",a.year>0&&"(".concat(a.year,")")]}),Object(m.jsxs)("p",{className:O.a.rating,children:["\u2b50 ",a.vote_average||"N/A","/10"]}),!c&&Object(m.jsxs)("p",{className:O.a.overview,children:[null===(t=a.overview)||void 0===t?void 0:t.substring(0,100),"..."]})]})]})};return Object(c.useEffect)(()=>{(async()=>{h(!0),u(""),l([]);try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null,c="cached_recs_".concat(n,"_").concat(a&&a.userId?a.userId:"public");try{const e=localStorage.getItem(c);if(e){const t=JSON.parse(e).results||[];t.length>0&&(l(t),h(!1))}}catch(e){}const s=a&&a.userId?"&user_id=".concat(encodeURIComponent(a.userId)):"",o="".concat(d,"/recommendations?rec_type=").concat(encodeURIComponent(n),"&n=10").concat(s),i=await fetch(o);if(!i.ok){const e=await i.text();throw new Error("L\u1ed7i l\u1ea5y g\u1ee3i \xfd: ".concat(i.status," - ").concat(e.substring(0,200)))}const r=(await i.json()).results||[];l(r);try{localStorage.setItem(c,JSON.stringify({ts:Date.now(),results:r}))}catch(e){}0===r.length&&u("Kh\xf4ng t\xecm th\u1ea5y g\u1ee3i \xfd n\xe0o.")}catch(t){u("Th\u1ea5t b\u1ea1i khi k\u1ebft n\u1ed1i: ".concat(t.message))}finally{h(!1)}})()},[]),Object(c.useEffect)(()=>{if(!window.YT){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}},[]),Object(c.useEffect)(()=>{if(!G||!D)return;const e=setInterval(()=>{try{if(D&&"function"===typeof D.getCurrentTime&&"function"===typeof D.getDuration){const e=D.getCurrentTime(),t=D.getDuration();e>0&&t>0&&K(G.id,e,t)}}catch(e){}},1e4);return()=>clearInterval(e)},[G,D]),Object(c.useEffect)(()=>{const e=()=>{if(G&&D)try{const e=D.getCurrentTime(),t=D.getDuration();e>0&&K(G.id,e,t)}catch(e){}};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[G,D]),Object(m.jsx)("div",{className:O.a.mainContent,children:G?Object(m.jsxs)("div",{className:O.a.moviePlayerContainer,children:[Object(m.jsx)("button",{className:O.a.backButton,onClick:()=>{if(b.length>1){const e=[...b];e.pop(),g(e)}else 1===b.length&&g([])},children:"\u2190 Quay l\u1ea1i"}),Object(m.jsxs)("div",{className:O.a.playerSection,children:[Object(m.jsx)("div",{className:O.a.videoPlayer,children:(()=>{const e=G.video_url?(e=>{if(!e)return null;if(e.includes("/embed"))try{const t=new URL(e);return t.hostname=t.hostname.replace("www.youtube.com","www.youtube-nocookie.com").replace("youtube.com","www.youtube-nocookie.com"),t.toString()}catch(t){return e}try{const t=new URL(e);if(t.hostname.includes("youtube.com")||t.hostname.includes("www.youtube.com")){const e=t.searchParams.get("v");if(e)return"https://www.youtube-nocookie.com/embed/".concat(e)}if(t.hostname.includes("youtu.be")){const e=t.pathname.slice(1).split("?")[0];if(e)return"https://www.youtube-nocookie.com/embed/".concat(e)}}catch(t){return console.error("Error parsing YouTube URL:",t),null}return null})(G.video_url)||G.video_url:null,t=!!e&&(e=>{if(!e)return!1;try{const t=new URL(e),a=t.searchParams;return"search"===a.get("listType")||!!(t.pathname&&t.pathname.includes("/embed")&&a.get("list"))}catch(t){return!1}})(e);if(e&&!t&&e.includes("/embed")){const t=e.includes("?")?"&":"?",a=A[G.id],c=(null===a||void 0===a?void 0:a.timestamp)>5?a.timestamp:0,s=c>0?"&start=".concat(c):"";return Object(m.jsx)("iframe",{id:"youtube-player-".concat(G.id),width:"100%",height:"100%",title:G.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,referrerPolicy:"strict-origin-when-cross-origin",src:"".concat(e).concat(t,"autoplay=1&mute=0&rel=0&modestbranding=1&enablejsapi=1").concat(s),onLoad:()=>{const e=()=>{if(window.YT&&window.YT.Player)try{new window.YT.Player("youtube-player-".concat(G.id),{events:{onReady:e=>{console.log("YouTube player ready"),E(e.target),L.current=e.target,c>5&&setTimeout(()=>{try{e.target.seekTo(c,!0)}catch(t){console.warn("Failed to seek:",t)}},1e3);const t=setInterval(()=>{try{const e=L.current;if(e&&"function"===typeof e.getCurrentTime){const t=e.getCurrentTime(),a=e.getDuration();t>0&&K(G.id,t,a)}}catch(e){}},1e4);return()=>clearInterval(t)},onStateChange:e=>{if(e.data===window.YT.PlayerState.PAUSED)try{const t=e.target.getCurrentTime(),a=e.target.getDuration();K(G.id,t,a)}catch(t){}}}})}catch(t){console.warn("Failed to initialize YouTube player:",t)}else setTimeout(e,500)};setTimeout(e,200)}})}return G.poster_url?Object(m.jsxs)("div",{className:O.a.noPoster,children:[Object(m.jsx)("img",{src:G.poster_url,alt:G.title,style:{width:"100%",height:"100%",objectFit:"contain"}}),Object(m.jsx)("div",{className:O.a.noVideoOverlay,children:G.loadingTrailer?"\u0110ang t\u1ea3i phim...":"Trailer kh\xf4ng kh\u1ea3 d\u1ee5ng"}),Object(m.jsx)("div",{style:{position:"absolute",right:12,bottom:12},children:Object(m.jsx)("button",{className:O.a.openYouTubeBtn,onClick:()=>window.open(G.video_url||"https://www.youtube.com/results?search_query=".concat(encodeURIComponent(G.title||"")),"_blank"),children:"M\u1edf trailer tr\xean YouTube"})})]}):Object(m.jsx)("div",{className:O.a.noVideo,children:G.loadingTrailer?"\u0110ang t\u1ea3i phim...":"Kh\xf4ng c\xf3 trailer"})})()}),Object(m.jsxs)("div",{className:O.a.movieInfo,children:[Object(m.jsxs)("h1",{className:O.a.movieInfoTitle,children:[G.title," ",G.year>0&&"(".concat(G.year,")")]}),Object(m.jsxs)("div",{className:O.a.movieMeta,children:[Object(m.jsxs)("span",{className:O.a.movieRating,children:["\u2b50 ",G.vote_average||"N/A","/10"]}),Object(m.jsxs)("span",{className:O.a.movieVotes,children:["(",G.vote_count||0," votes)"]})]}),Object(m.jsx)("p",{className:O.a.movieDescription,children:G.overview}),Object(m.jsxs)("div",{className:O.a.interactionButtons,children:[Object(m.jsx)("button",{className:"".concat(O.a.likeBtn," ").concat(_[G.id]?O.a.active:""),onClick:async()=>{if(G)try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null;a&&a.userId?await fetch("".concat(d,"/interactions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.userId,movieId:G.id,action:"like"})}):await fetch("".concat(d,"/movies/").concat(G.id,"/like"),{method:"POST"});const c=G.id,s=_[c];if(f(e=>Object(i.a)(Object(i.a)({},e),{},{[c]:!s})),s){if(a&&a.userId)try{const e="likes_cache_".concat(a.userId),t=localStorage.getItem(e),s=t?JSON.parse(t):{};delete s[c],localStorage.setItem(e,JSON.stringify(s))}catch(e){console.warn("Failed to update like cache:",e)}}else if(N(e=>Object(i.a)(Object(i.a)({},e),{},{[c]:!1})),a&&a.userId)try{const e="likes_cache_".concat(a.userId),t=localStorage.getItem(e),s=t?JSON.parse(t):{};s[c]="like",localStorage.setItem(e,JSON.stringify(s))}catch(e){console.warn("Failed to save like cache:",e)}}catch(t){console.error("Failed to like movie:",t)}},title:"Th\xedch phim n\xe0y",children:"\ud83d\udc4d Th\xedch"}),Object(m.jsx)("button",{className:"".concat(O.a.dislikeBtn," ").concat(x[G.id]?O.a.active:""),onClick:async()=>{if(G)try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null;a&&a.userId?await fetch("".concat(d,"/interactions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.userId,movieId:G.id,action:"dislike"})}):await fetch("".concat(d,"/movies/").concat(G.id,"/dislike"),{method:"POST"});const c=G.id,s=x[c];if(N(e=>Object(i.a)(Object(i.a)({},e),{},{[c]:!s})),s){if(a&&a.userId)try{const e="likes_cache_".concat(a.userId),t=localStorage.getItem(e),s=t?JSON.parse(t):{};delete s[c],localStorage.setItem(e,JSON.stringify(s))}catch(e){console.warn("Failed to update dislike cache:",e)}}else if(f(e=>Object(i.a)(Object(i.a)({},e),{},{[c]:!1})),a&&a.userId)try{const e="likes_cache_".concat(a.userId),t=localStorage.getItem(e),s=t?JSON.parse(t):{};s[c]="dislike",localStorage.setItem(e,JSON.stringify(s))}catch(e){console.warn("Failed to save dislike cache:",e)}}catch(t){console.error("Failed to dislike movie:",t)}},title:"Kh\xf4ng th\xedch",children:"\ud83d\udc4e Kh\xf4ng th\xedch"}),Object(m.jsx)("button",{className:"".concat(O.a.watchlistBtn," ").concat(y[G.id]?O.a.active:""),onClick:async()=>{if(G)try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null,c=(null===a||void 0===a?void 0:a.userId)||"Anonymous",s=y[G.id],n=s?"remove_from_watchlist":"add_to_watchlist";await fetch("".concat(d,"/watchlist"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c,movieId:G.id,action:n})}),S(e=>Object(i.a)(Object(i.a)({},e),{},{[G.id]:!s}));try{const e="watchlist_".concat(c),t=localStorage.getItem(e);let a=t?JSON.parse(t):[];s?a=a.filter(e=>e.id!==G.id):a.push(G),localStorage.setItem(e,JSON.stringify(a))}catch(e){console.warn("Failed to update watchlist cache:",e)}}catch(t){console.error("Failed to update watchlist:",t)}},title:y[G.id]?"X\xf3a kh\u1ecfi danh s\xe1ch":"L\u01b0u v\xe0o danh s\xe1ch",children:y[G.id]?"\u2713 \u0110\xe3 l\u01b0u":"+ L\u01b0u"}),Object(m.jsx)("div",{className:O.a.ratingInline,children:[1,2,3,4,5].map(e=>Object(m.jsx)("button",{className:"".concat(O.a.star," ").concat((B||w)>=e?O.a.starActive:""),onClick:()=>(async e=>{if(G)try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null,c={rating:e,review_text:"",username:a&&a.userId?a.userId:"Anonymous"};(await fetch("".concat(d,"/movies/").concat(G.id,"/review"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).ok?(I(e),alert("C\u1ea3m \u01a1n b\u1ea1n \u0111\xe3 \u0111\xe1nh gi\xe1!")):alert("G\u1eedi \u0111\xe1nh gi\xe1 th\u1ea5t b\u1ea1i")}catch(t){console.error("Failed to submit rating:",t),alert("L\u1ed7i khi g\u1eedi \u0111\xe1nh gi\xe1. Vui l\xf2ng th\u1eed l\u1ea1i!")}})(e),onMouseEnter:()=>F(e),onMouseLeave:()=>F(0),title:"\u0110\xe1nh gi\xe1 ".concat(e," sao"),children:"\u2b50"},e))})]}),Object(m.jsxs)("div",{className:O.a.commentsSection,children:[Object(m.jsx)("h3",{children:"B\xecnh lu\u1eadn"}),Object(m.jsxs)("div",{className:O.a.commentForm,children:[Object(m.jsx)("textarea",{value:C,onChange:e=>T(e.target.value),placeholder:"Vi\u1ebft b\xecnh lu\u1eadn...",rows:3}),Object(m.jsx)("button",{className:O.a.submitBtn,onClick:async()=>{if(G)try{const t=localStorage.getItem("user"),a=t?JSON.parse(t):null,c={userId:a&&a.userId?a.userId:"Anonymous",comment:C||""};if(a&&a.userId&&(a.name||a.email))try{await fetch("".concat(d,"/users"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.userId,metadata:JSON.stringify({name:a.name,email:a.email})})})}catch(e){}if(!c.comment.trim())return void alert("Vui l\xf2ng nh\u1eadp b\xecnh lu\u1eadn");const s=await fetch("".concat(d,"/movies/").concat(G.id,"/comment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(s.ok){await s.json();const e=a&&(a.name||a.displayName)||c.userId;P(t=>[{id:Date.now(),movieId:G.id,userId:c.userId,display_name:e,comment:c.comment,timestamp:(new Date).toISOString()},...t]),T("")}else alert("G\u1eedi b\xecnh lu\u1eadn th\u1ea5t b\u1ea1i")}catch(e){console.error("Failed to submit comment",e),alert("L\u1ed7i khi g\u1eedi b\xecnh lu\u1eadn")}},children:"G\u1eedi"})]}),Object(m.jsxs)("div",{className:O.a.commentList,children:[0===k.length&&Object(m.jsx)("div",{children:"Ch\u01b0a c\xf3 b\xecnh lu\u1eadn n\xe0o."}),k.length>0&&(R?k:k.slice(0,2)).map(e=>Object(m.jsxs)("div",{className:O.a.commentItem,children:[Object(m.jsxs)("div",{className:O.a.commentMeta,children:[Object(m.jsx)("strong",{children:e.display_name||e.userId})," \u2022 ",Object(m.jsx)("span",{className:O.a.commentTime,children:new Date(e.timestamp).toLocaleString()})]}),Object(m.jsx)("div",{className:O.a.commentText,children:e.comment})]},e.id)),k.length>2&&Object(m.jsx)("div",{className:O.a.commentToggle,children:Object(m.jsx)("button",{className:O.a.smallBtn,onClick:()=>J(e=>!e),children:R?"R\xfat g\u1ecdn":"Xem th\xeam ".concat(k.length-2," b\xecnh lu\u1eadn")})})]})]})]})]}),Object(m.jsxs)("div",{className:O.a.similarMoviesSection,children:[Object(m.jsx)("h2",{className:O.a.sectionTitle,children:"G\u1ee3i \xfd cho b\u1ea1n"}),H.length>0?Object(m.jsx)("div",{className:O.a.similarMoviesGrid,children:H.map((e,t)=>Object(m.jsx)(Y,{movie:e,isCompact:!0},t))}):Object(m.jsx)("div",{className:O.a.loadingMovies,children:"\u0110ang t\u1ea3i..."})]}),Object(m.jsx)("div",{style:{marginTop:12},children:Object(m.jsx)("button",{className:O.a.openYouTubeBtn,onClick:()=>{const e=(null===G||void 0===G?void 0:G.title)||"",t=null!==G&&void 0!==G&&G.year?" ".concat(G.year):"",a=encodeURIComponent("".concat(e).concat(t," trailer"));window.open("https://www.youtube.com/results?search_query=".concat(a),"_blank")},children:"M\u1edf trailer tr\xean YouTube"})})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("header",{className:O.a.header,children:Object(m.jsx)("h1",{className:O.a.pageHeader,children:"\u2b50 \u0110\u1ec1 Xu\u1ea5t Phim Cho B\u1ea1n"})}),j&&Object(m.jsx)("div",{className:O.a.error,children:j}),r&&0===o.length&&Object(m.jsxs)("div",{className:O.a.recommendationsContainer,children:[Object(m.jsx)("div",{className:O.a.skeletonTitle}),Object(m.jsx)("div",{className:O.a.movieRow,children:Array.from({length:6}).map((e,t)=>Object(m.jsxs)("div",{className:O.a.movieCardSkeleton,children:[Object(m.jsx)("div",{className:O.a.skeletonPoster}),Object(m.jsx)("div",{className:O.a.skeletonText}),Object(m.jsx)("div",{className:O.a.skeletonText,style:{width:"60%"}})]},t))})]}),o.length>0&&Object(m.jsxs)("div",{className:O.a.recommendationsContainer,children:[Object(m.jsxs)("h2",{className:O.a.rowTitle,children:["\ud83c\udfac \u0110\u1ec1 xu\u1ea5t h\xe0ng \u0111\u1ea7u (",o.length,")"]}),Object(m.jsx)("div",{className:O.a.movieRow,children:o.map((e,t)=>Object(m.jsx)(Y,{movie:e},t))})]})]})})}a(15);function _(){var e;const[t,a]=Object(c.useState)(null),[s,n]=Object(c.useState)(null),[o,l]=Object(c.useState)({}),[r,h]=Object(c.useState)([]),[j,u]=Object(c.useState)([]),[b,g]=Object(c.useState)({}),[v,O]=Object(c.useState)(!0),[p,_]=Object(c.useState)(!0),[f,x]=Object(c.useState)("720p"),[N,y]=Object(c.useState)(["vi","en"]),[S,w]=Object(c.useState)(!1),[I,k]=Object(c.useState)(!1);Object(c.useEffect)(()=>{const e=localStorage.getItem("user");if(e){const t=JSON.parse(e);a(t),P(t.userId)}else O(!1)},[]);const P=async e=>{try{const t="profile_".concat(e),a=localStorage.getItem(t);if(a){const e=JSON.parse(a);n(e.profile),l(e.preferences||{}),h(e.watchlist||[]),u(e.history||[]),O(!1),_(!1)}}catch(t){}try{const a=await fetch("".concat(d,"/user/").concat(e,"/profile"));if(a.ok){const c=await a.json();n(c);try{const t=await fetch("".concat(d,"/user/").concat(e,"/preferences"));if(t.ok){const e=await t.json();l(e.preferences||{})}}catch(t){console.warn("Failed to fetch preferences:",t)}try{const t="watchlist_".concat(e),a=localStorage.getItem(t);if(a){const e=JSON.parse(a),t=[],c=new Set;e.forEach(e=>{c.has(e.id)||(c.add(e.id),t.push(e))}),h(t);const s={};e.forEach(e=>{s[e.id]=e}),g(e=>Object(i.a)(Object(i.a)({},e),s))}else{const t=await fetch("".concat(d,"/watchlist/").concat(e));if(t.ok){const e=await t.json();h(e.movies||e.watchlist||[])}}}catch(t){console.warn("Failed to fetch watchlist:",t)}try{const a=await fetch("".concat(d,"/watch-history/").concat(e));if(a.ok){const e=await a.json(),c=e.movies||e.history||[],s=[],n=new Set;c.forEach(e=>{n.has(e.movieId)||(n.add(e.movieId),s.push(e))}),u(s);if(c.map(e=>e.movieId).filter(Boolean).length>0)try{const e=await fetch("".concat(d,"/movies/trending?limit=100"));if(e.ok){const t=await e.json(),a=t.movies||t.data||t||[],c={};a.forEach(e=>{c[e.id]=e}),g(e=>Object(i.a)(Object(i.a)({},e),c))}}catch(t){console.warn("Failed to fetch movie details:",t)}}}catch(t){console.warn("Failed to fetch history:",t)}try{const t="profile_".concat(e);localStorage.setItem(t,JSON.stringify({profile:c,preferences:o,watchlist:r,history:j}))}catch(t){}}O(!1),_(!1)}catch(a){console.error("Failed to fetch profile:",a),O(!1),_(!1)}},C=async e=>{y(e),localStorage.setItem("subtitle_languages",JSON.stringify(e))},T=async e=>{try{(await fetch("".concat(d,"/user/").concat(t.userId,"/preferences"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({favorite_genres:e,quality:f,languages:N})})).ok&&l(Object(i.a)(Object(i.a)({},o),{},{favorite_genres:e}))}catch(a){console.error("Failed to update preferences:",a)}};return p?Object(m.jsx)("div",{className:"profile-page",children:Object(m.jsxs)("div",{className:"profile-container",children:[Object(m.jsxs)("div",{className:"profile-header",children:[Object(m.jsx)("div",{className:"profile-avatar skeleton-avatar",children:"\ud83d\udc64"}),Object(m.jsxs)("div",{className:"profile-info",children:[Object(m.jsx)("div",{className:"skeleton-text skeleton-title"}),Object(m.jsx)("div",{className:"skeleton-text skeleton-subtitle"})]})]}),Object(m.jsxs)("div",{className:"settings-section",children:[Object(m.jsx)("div",{className:"skeleton-text skeleton-heading"}),Object(m.jsx)("div",{className:"skeleton-box"})]}),Object(m.jsxs)("div",{className:"watchlist-section",children:[Object(m.jsx)("div",{className:"skeleton-text skeleton-heading"}),Object(m.jsx)("div",{className:"movies-grid",children:Array.from({length:6}).map((e,t)=>Object(m.jsx)("div",{className:"movie-card-skeleton"},t))})]})]})}):t?Object(m.jsx)("div",{className:"profile-page",children:Object(m.jsxs)("div",{className:"profile-container",children:[Object(m.jsxs)("div",{className:"profile-header",children:[Object(m.jsx)("div",{className:"profile-avatar",children:"\ud83d\udc64"}),Object(m.jsxs)("div",{className:"profile-info",children:[Object(m.jsx)("h1",{children:t.userId}),s&&Object(m.jsxs)("p",{children:[s.watched_count," phim \u0111\xe3 xem \u2022 ",s.watchlist_count," phim \u0111\xe3 l\u01b0u"]})]})]}),Object(m.jsxs)("div",{className:"settings-section",children:[Object(m.jsx)("h2",{children:"\u2699\ufe0f C\xe0i \u0110\u1eb7t"}),Object(m.jsxs)("div",{className:"setting-group",children:[Object(m.jsx)("h3",{children:"Ch\u1ea5t L\u01b0\u1ee3ng Video"}),Object(m.jsx)("div",{className:"quality-options",children:["480p","720p","1080p","4K"].map(e=>Object(m.jsx)("button",{className:"quality-btn ".concat(f===e?"active":""),onClick:()=>(async e=>{x(e),localStorage.setItem("video_quality",e)})(e),children:e},e))})]}),Object(m.jsxs)("div",{className:"setting-group",children:[Object(m.jsx)("h3",{children:"Ng\xf4n Ng\u1eef Ph\u1ee5 \u0110\u1ec1"}),Object(m.jsx)("div",{className:"language-options",children:[{code:"vi",name:"Ti\u1ebfng Vi\u1ec7t"},{code:"en",name:"English"},{code:"zh",name:"\u4e2d\u6587"}].map(e=>Object(m.jsxs)("label",{className:"language-checkbox",children:[Object(m.jsx)("input",{type:"checkbox",checked:N.includes(e.code),onChange:t=>{t.target.checked?C([...N,e.code]):C(N.filter(t=>t!==e.code))}}),e.name]},e.code))})]}),Object(m.jsxs)("div",{className:"setting-group",children:[Object(m.jsx)("h3",{children:"Th\u1ec3 Lo\u1ea1i Y\xeau Th\xedch"}),Object(m.jsx)("div",{className:"genre-options",children:["Action","Comedy","Drama","Horror","Romance","Sci-Fi"].map(e=>{var t;return Object(m.jsx)("button",{className:"genre-btn ".concat(null!==(t=o.favorite_genres)&&void 0!==t&&t.includes(e)?"active":""),onClick:()=>{const t=o.favorite_genres||[];t.includes(e)?T(t.filter(t=>t!==e)):T([...t,e])},children:e},e)})})]})]}),Object(m.jsxs)("div",{className:"stats-section",children:[Object(m.jsx)("h2",{children:"\ud83d\udcca Th\u1ed1ng K\xea"}),Object(m.jsxs)("div",{className:"stats-grid",children:[Object(m.jsxs)("div",{className:"stat-card",children:[Object(m.jsx)("div",{className:"stat-value",children:(null===s||void 0===s?void 0:s.total_ratings)||0}),Object(m.jsx)("div",{className:"stat-label",children:"\u0110\xe1nh Gi\xe1"})]}),Object(m.jsxs)("div",{className:"stat-card",children:[Object(m.jsx)("div",{className:"stat-value",children:(null===r||void 0===r?void 0:r.length)||0}),Object(m.jsx)("div",{className:"stat-label",children:"Phim \u0110\xe3 L\u01b0u"})]}),Object(m.jsxs)("div",{className:"stat-card",children:[Object(m.jsx)("div",{className:"stat-value",children:(null===(e=o.favorite_genres)||void 0===e?void 0:e.length)||0}),Object(m.jsx)("div",{className:"stat-label",children:"Th\u1ec3 Lo\u1ea1i Y\xeau Th\xedch"})]})]})]}),(null===j||void 0===j?void 0:j.length)>0&&Object(m.jsxs)("div",{className:"activity-section",children:[Object(m.jsxs)("h2",{children:["\ud83d\udcfa L\u1ecbch S\u1eed Xem (",j.length,")"]}),Object(m.jsx)("div",{className:"movies-grid",children:j.slice(0,S?j.length:5).map(e=>{const t=b[e.movieId];return t?Object(m.jsxs)("div",{className:"movie-poster-card",children:[Object(m.jsx)("div",{className:"movie-poster-wrapper",children:t.poster_url?Object(m.jsx)("img",{src:t.poster_url,alt:t.title,className:"movie-poster"}):Object(m.jsx)("div",{className:"no-poster",children:"Kh\xf4ng c\xf3 poster"})}),Object(m.jsxs)("div",{className:"movie-poster-info",children:[Object(m.jsx)("h4",{className:"movie-poster-title",children:t.title}),Object(m.jsxs)("p",{className:"movie-poster-meta",children:["\u2b50 ",t.vote_average||"N/A"]}),Object(m.jsx)("p",{className:"movie-watch-date",children:new Date(e.viewed_at||e.timestamp).toLocaleDateString("vi-VN")})]})]},e.movieId):null})}),j.length>5&&Object(m.jsx)("div",{className:"show-more-container",children:Object(m.jsx)("button",{className:"show-more-btn",onClick:()=>w(!S),children:S?"\u25b2 Thu g\u1ecdn":"\u25bc Xem th\xeam (".concat(j.length-5," phim)")})})]}),(null===r||void 0===r?void 0:r.length)>0&&Object(m.jsxs)("div",{className:"activity-section",children:[Object(m.jsxs)("h2",{children:["\u2764\ufe0f Danh S\xe1ch \u0110\xe3 L\u01b0u (",r.length,")"]}),Object(m.jsx)("div",{className:"movies-grid",children:r.slice(0,I?r.length:5).map(e=>Object(m.jsxs)("div",{className:"movie-poster-card",children:[Object(m.jsx)("div",{className:"movie-poster-wrapper",children:e.poster_url?Object(m.jsx)("img",{src:e.poster_url,alt:e.title,className:"movie-poster"}):Object(m.jsx)("div",{className:"no-poster",children:"Kh\xf4ng c\xf3 poster"})}),Object(m.jsxs)("div",{className:"movie-poster-info",children:[Object(m.jsx)("h4",{className:"movie-poster-title",children:e.title}),Object(m.jsxs)("p",{className:"movie-poster-meta",children:["\u2b50 ",e.vote_average||"N/A"]}),Object(m.jsx)("button",{className:"remove-btn",onClick:()=>(async e=>{try{const c=await fetch("".concat(d,"/watchlist"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({movie_id:e,user_id:t.userId,action:"remove"})});if(c.ok){const c=r.filter(t=>t.id!==e);h(c);try{const e="watchlist_".concat(t.userId);localStorage.setItem(e,JSON.stringify(c))}catch(a){console.warn("Failed to update watchlist cache:",a)}}else console.error("Failed to remove from watchlist:",await c.text())}catch(c){console.error("Failed to remove from watchlist:",c)}})(e.id),children:"\ud83d\uddd1\ufe0f X\xf3a"})]})]},e.id))}),r.length>5&&Object(m.jsx)("div",{className:"show-more-container",children:Object(m.jsx)("button",{className:"show-more-btn",onClick:()=>k(!I),children:I?"\u25b2 Thu g\u1ecdn":"\u25bc Xem th\xeam (".concat(r.length-5," phim)")})})]})]})}):Object(m.jsx)("div",{className:"profile-page",children:Object(m.jsx)("p",{children:"Please login first"})})}a(16);function f(e){let{movie:t,onClick:a}=e;const c=t.poster_url||t.poster_path||t.poster;return Object(m.jsxs)("div",{className:"collection-movie-card",onClick:()=>a&&a(t),children:[Object(m.jsxs)("div",{className:"collection-movie-thumb",children:[c?Object(m.jsx)("img",{src:c,alt:t.title,loading:"lazy",decoding:"async",onError:e=>{e.target.onerror=null,e.target.src="https://picsum.photos/seed/".concat(t.id||t.title,"/300/450")}}):Object(m.jsx)("div",{className:"no-poster",children:"Kh\xf4ng c\xf3 poster"}),Object(m.jsx)("div",{className:"collection-overlay",children:Object(m.jsx)("button",{className:"btn-play",children:"\u25b6 Xem ngay"})})]}),Object(m.jsx)("h3",{children:t.title}),Object(m.jsx)("p",{className:"movie-year",children:t.year})]})}function x(e){let{onMovieClick:t}=e;const[a]=Object(c.useState)([{id:"horror",name:"Horror Collection"},{id:"action",name:"Action Movies"},{id:"top_rated",name:"Top Rated"}]),[s,n]=Object(c.useState)("horror"),[o,i]=Object(c.useState)([]),[l,r]=Object(c.useState)(null),[h,j]=Object(c.useState)(!1);Object(c.useEffect)(()=>{u(s)},[s]);const u=async e=>{j(!0);const t="collection_".concat(e),a=localStorage.getItem(t);if(a)try{const e=JSON.parse(a);r(e),i(e.movies||[]),j(!1)}catch(c){}try{const s=await fetch("".concat(d,"/collections/").concat(e,"?limit=30"));if(s.ok){const e=await s.json();r(e),i(e.movies||[]);try{localStorage.setItem(t,JSON.stringify(e))}catch(c){}}else console.error("Failed to fetch collection:",s.status),a||(r(null),i([]))}catch(s){console.error("Failed to fetch collection:",s),a||(r(null),i([]))}finally{j(!1)}};return Object(m.jsxs)("div",{className:"collections-page",children:[Object(m.jsxs)("div",{className:"collections-header",children:[Object(m.jsx)("h1",{children:"\ud83c\udfac B\u1ed9 S\u01b0u T\u1eadp Phim"}),Object(m.jsx)("p",{children:"Kh\xe1m ph\xe1 nh\u1eefng b\u1ed9 s\u01b0u t\u1eadp phim \u0111\u01b0\u1ee3c c\u1ed1 g\u1eafng s\u1eafp x\u1ebfp"})]}),Object(m.jsx)("div",{className:"collections-tabs",children:a.map(e=>Object(m.jsx)("button",{className:"collection-tab ".concat(s===e.id?"active":""),onClick:()=>n(e.id),children:e.name},e.id))}),l&&Object(m.jsxs)("div",{className:"collection-info",children:[Object(m.jsx)("h2",{children:l.title}),Object(m.jsx)("p",{children:l.description})]}),Object(m.jsx)("div",{className:"collections-grid",children:h&&0===o.length?Array.from({length:12}).map((e,t)=>Object(m.jsxs)("div",{className:"collection-movie-card skeleton",children:[Object(m.jsx)("div",{className:"collection-movie-thumb"}),Object(m.jsx)("h3",{children:"\xa0"}),Object(m.jsx)("p",{className:"movie-year",children:"\xa0"})]},"skeleton-".concat(t))):o.map((e,a)=>Object(m.jsx)(f,{movie:e,onClick:t},e.id||a))}),0===o.length&&!h&&Object(m.jsx)("div",{className:"no-movies",children:Object(m.jsx)("p",{children:"Kh\xf4ng c\xf3 phim trong b\u1ed9 s\u01b0u t\u1eadp n\xe0y"})})]})}function N(){const[e,t]=Object(c.useState)(!1),[a,s]=Object(c.useState)("home"),[n,o]=Object(c.useState)(["home"]),[i,l]=Object(c.useState)(null),[r,d]=Object(c.useState)(null),j=()=>{const e="collection_best_2024";localStorage.getItem(e)||fetch("".concat("http://backend:8000","/collections/best_2024?limit=30")).then(e=>e.ok?e.json():null).then(t=>{if(t)try{localStorage.setItem(e,JSON.stringify(t))}catch(a){}}).catch(()=>{})};Object(c.useEffect)(()=>{const e=localStorage.getItem("user");if(e){const c=JSON.parse(e);if(!c.userId){c.userId="user_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,9)),localStorage.setItem("user",JSON.stringify(c));try{fetch("".concat("http://backend:8000","/users"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c.userId,metadata:JSON.stringify({name:c.name,email:c.email})})}).catch(()=>{})}catch(a){}}l(c),t(!0),setTimeout(()=>{j(),(()=>{const e=(null===i||void 0===i?void 0:i.userId)||"Anonymous",t="cached_recs_hybrid_".concat(e);localStorage.getItem(t)||fetch("".concat("http://backend:8000","/recommendations?rec_type=hybrid&n=20&user_id=").concat(e)).then(e=>e.ok?e.json():null).then(e=>{if(e)try{localStorage.setItem(t,JSON.stringify(e))}catch(a){}}).catch(()=>{})})()},500)}},[]);const u=()=>{const e=localStorage.getItem("user");e&&(l(JSON.parse(e)),t(!0))},b=e=>{o([...n,e]),s(e)},v=e=>{d(e),b("watch")},O=()=>{if(n.length>1){const e=[...n];e.pop();const t=e[e.length-1];o(e),s(t),"watch"!==t&&d(null)}};return e?Object(m.jsxs)("div",{className:"app-container",children:[Object(m.jsxs)("aside",{className:"sidebar",children:[Object(m.jsx)("div",{className:"sidebar-header",children:Object(m.jsx)("h1",{className:"brand-text",children:"FilmFlow"})}),Object(m.jsxs)("nav",{className:"sidebar-nav",children:[Object(m.jsx)("button",{className:"nav-link ".concat("home"===a?"active":""),onClick:()=>b("home"),children:Object(m.jsx)("span",{className:"nav-text",children:"Trang ch\u1ee7"})}),Object(m.jsx)("button",{className:"nav-link ".concat("collections"===a?"active":""),onClick:()=>b("collections"),onMouseEnter:j,children:Object(m.jsx)("span",{className:"nav-text",children:"B\u1ed9 S\u01b0u T\u1eadp"})}),Object(m.jsx)("button",{className:"nav-link ".concat("profile"===a?"active":""),onClick:()=>b("profile"),children:Object(m.jsx)("span",{className:"nav-text",children:"H\u1ed3 S\u01a1"})}),Object(m.jsxs)("div",{className:"sidebar-footer",children:[Object(m.jsx)("div",{className:"user-info",children:Object(m.jsx)("span",{className:"user-name",children:(null===i||void 0===i?void 0:i.name)||(null===i||void 0===i?void 0:i.email)})}),Object(m.jsx)("button",{className:"nav-link logout-btn",onClick:()=>{localStorage.removeItem("user"),l(null),t(!1),s("home"),o(["home"])},children:Object(m.jsx)("span",{className:"nav-text",children:"\u0110\u0103ng xu\u1ea5t"})})]})]})]}),Object(m.jsxs)("main",{className:"main-content",children:["home"===a&&Object(m.jsx)(g,{onMovieClick:v}),"recommendations"===a&&Object(m.jsx)(p,{onBack:O}),"collections"===a&&Object(m.jsx)(x,{onMovieClick:v}),"profile"===a&&Object(m.jsx)(_,{}),"watch"===a&&Object(m.jsx)(p,{onBack:O,initialMovie:r})]})]}):Object(m.jsx)(h,{onLogin:u})}o.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(N,{})}),document.getElementById("root"))}],[[17,1,2]]]);
//# sourceMappingURL=main.4b467b90.chunk.js.map