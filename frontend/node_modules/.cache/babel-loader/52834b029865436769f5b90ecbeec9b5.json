{"ast":null,"code":"import _objectSpread from\"D:/cn/phim/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef}from'react';import'./HomePage.css';import{API_BASE}from'../config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MovieCard(_ref){let{movie,commentCounts,onClick,onWatchlistClick,isInWatchlist}=_ref;const poster=movie.poster_url||movie.poster_path||movie.poster;return/*#__PURE__*/_jsx(\"div\",{className:\"movie-card\",onClick:()=>onClick&&onClick(movie),children:/*#__PURE__*/_jsxs(\"div\",{className:\"movie-thumb\",children:[poster?/*#__PURE__*/_jsx(\"img\",{src:poster,alt:movie.title,loading:\"lazy\"}):/*#__PURE__*/_jsx(\"div\",{className:\"no-poster\",children:\"Kh\\xF4ng c\\xF3 poster\"}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"overlay-content\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"movie-title\",children:movie.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"movie-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"year\",children:movie.year}),/*#__PURE__*/_jsxs(\"span\",{className:\"rating\",children:[\"\\u2B50 \",movie.vote_average||'N/A']}),/*#__PURE__*/_jsxs(\"span\",{className:\"comments\",children:[\"\\uD83D\\uDCAC \",commentCounts&&(commentCounts[movie.id]||0)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"movie-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-play\",onClick:e=>{e.stopPropagation();onClick&&onClick(movie);},children:\"\\u25B6 Xem phim\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-watchlist \".concat(isInWatchlist?'active':''),onClick:e=>{e.stopPropagation();onWatchlistClick&&onWatchlistClick(movie);},children:[isInWatchlist?'‚ù§Ô∏è':'ü§ç',\" L\\u01B0u\"]})]})]})})]})});}export default function HomePage(_ref2){let{onMovieClick}=_ref2;const[allMovies,setAllMovies]=useState([]);const[commentCounts,setCommentCounts]=useState({});const[featuredMovies,setFeaturedMovies]=useState([]);const[newMovies,setNewMovies]=useState([]);const[topRatedMovies,setTopRatedMovies]=useState([]);const[trendingMovies,setTrendingMovies]=useState([]);const[watchHistory,setWatchHistory]=useState([]);const[watchlist,setWatchlist]=useState([]);const[loading,setLoading]=useState(true);const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[isSearching,setIsSearching]=useState(false);const searchTimeoutRef=useRef(null);// Filter states\nconst[genreFilter,setGenreFilter]=useState('all');const[yearFilter,setYearFilter]=useState('all');const[sortBy,setSortBy]=useState('rating');const handleSearch=async query=>{setSearchQuery(query);if(searchTimeoutRef.current){clearTimeout(searchTimeoutRef.current);}if(query.trim().length>0){searchTimeoutRef.current=setTimeout(async()=>{setIsSearching(true);try{const response=await fetch(\"\".concat(API_BASE,\"/movies/autocomplete?q=\").concat(encodeURIComponent(query),\"&n=12\"));if(response.ok){const data=await response.json();setSearchResults(data.results||[]);}else{setSearchResults([]);}}catch(error){console.error('Search failed:',error);setSearchResults([]);}},200);}else{setIsSearching(false);setSearchResults([]);}};const fetchCommentCounts=async movies=>{try{const ids=movies.map(m=>m.id).filter(Boolean);if(!ids.length)return;const resp=await fetch(\"\".concat(API_BASE,\"/movies/comments/counts\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({movie_ids:ids})});if(resp.ok){const d=await resp.json();const counts=d.counts||d||{};setCommentCounts(prev=>_objectSpread(_objectSpread({},prev),counts));}}catch(e){console.error('Failed to fetch comment counts:',e);}};const handleWatchlistClick=async movie=>{var _JSON$parse;const storedUser=localStorage.getItem('user');const userId=storedUser?(_JSON$parse=JSON.parse(storedUser))===null||_JSON$parse===void 0?void 0:_JSON$parse.userId:'Anonymous';const isInWatchlist=watchlist.some(w=>w.movieId===movie.id);try{const response=await fetch(\"\".concat(API_BASE,\"/watchlist\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({movie_id:movie.id,user_id:userId,action:isInWatchlist?'remove':'add'})});if(response.ok){if(isInWatchlist){setWatchlist(prev=>prev.filter(w=>w.movieId!==movie.id));}else{setWatchlist(prev=>[...prev,{movieId:movie.id,added_at:new Date().toISOString()}]);}}}catch(error){console.error('Failed to update watchlist:',error);}};const isMovieInWatchlist=movieId=>watchlist.some(w=>w.movieId===movieId);// Map Vietnamese genre names to English equivalents\nconst genreMap={'action':['action','h√†nh ƒë·ªông'],'comedy':['comedy','h√†i'],'drama':['drama','ch√≠nh k·ªãch'],'horror':['horror','kinh d·ªã'],'romance':['romance','l√£ng m·∫°n']};const filterMovies=movies=>{let filtered=[...movies];// Genre filter - match both English and Vietnamese names\nif(genreFilter!=='all'){const targetGenres=genreMap[genreFilter.toLowerCase()]||[genreFilter.toLowerCase()];filtered=filtered.filter(m=>{try{let genres=m.genres;if(typeof genres==='string'){genres=JSON.parse(genres);}if(Array.isArray(genres)){const genreNames=genres.map(g=>{if(typeof g==='string')return g.toLowerCase();if(g.name)return g.name.toLowerCase();return'';});// Check if any genre name matches any target genre\nreturn genreNames.some(gn=>targetGenres.some(tg=>gn.includes(tg)||tg.includes(gn)));}return false;}catch(e){console.warn('Genre parse error:',e);return false;}});}// Year filter\nif(yearFilter!=='all'){if(yearFilter==='2024'){filtered=filtered.filter(m=>m.year>=2024);}else if(yearFilter==='2023'){filtered=filtered.filter(m=>m.year===2023);}else if(yearFilter==='2020-2022'){filtered=filtered.filter(m=>m.year>=2020&&m.year<=2022);}else if(yearFilter==='older'){filtered=filtered.filter(m=>m.year<2020);}}// Sorting\nif(sortBy==='rating'){filtered.sort((a,b)=>(b.vote_average||0)-(a.vote_average||0));}else if(sortBy==='newest'){filtered.sort((a,b)=>(b.year||0)-(a.year||0));}else if(sortBy==='title'){filtered.sort((a,b)=>(a.title||'').localeCompare(b.title||''));}return filtered;};useEffect(()=>{const fetchMovies=async()=>{var _JSON$parse2;const storedUser=localStorage.getItem('user');const userId=storedUser?(_JSON$parse2=JSON.parse(storedUser))===null||_JSON$parse2===void 0?void 0:_JSON$parse2.userId:null;// PRIORITY 1: Fetch essential data for quick display (trending + featured)\ntry{// Try cache first for featured/recommendations\nconst cacheKey=\"cached_recs_collaborative_\".concat(userId||'public');const cached=localStorage.getItem(cacheKey);let hasCached=false;if(cached){try{const parsed=JSON.parse(cached);const movies=parsed.results||[];if(movies.length>0){const featured=movies.filter(m=>m.vote_average>=7).slice(0,6);setFeaturedMovies(featured);setAllMovies(movies);setTopRatedMovies([...movies].sort((a,b)=>(b.vote_average||0)-(a.vote_average||0)).slice(0,12));hasCached=true;}}catch(e){}}// Fetch trending in parallel (most important)\nconst trendingRes=await fetch(\"\".concat(API_BASE,\"/movies/trending?limit=12\"));if(trendingRes.ok){const data=await trendingRes.json();let movies=data.movies||[];// If we got movieIds only, fetch full details for first 6 (visible ones)\nif(movies.length>0&&!movies[0].title){const movieIds=movies.slice(0,6).map(m=>m.movieId||m.id).filter(Boolean);if(movieIds.length>0){try{const detailsPromises=movieIds.map(id=>fetch(\"\".concat(API_BASE,\"/movies/\").concat(id)).then(r=>r.ok?r.json():null).catch(()=>null));const details=await Promise.all(detailsPromises);const fullMovies=details.filter(Boolean);if(fullMovies.length>0){// Add interaction counts to full movies\nfullMovies.forEach((fm,idx)=>{const orig=movies[idx];if(orig&&orig.interaction_count){fm.interaction_count=orig.interaction_count;}});movies=fullMovies;}}catch(e){console.warn('Failed to fetch movie details:',e);}}}setTrendingMovies(movies);}// SET LOADING FALSE EARLY - show UI now instead of waiting for recommendations\nsetLoading(false);// Fetch featured recommendations (in background, async, don't wait)\nfetch(\"\".concat(API_BASE,\"/recommendations?rec_type=collaborative&n=24\")).then(recResp=>{if(recResp.ok){return recResp.json();}return null;}).then(data=>{if(data){const movies=data.results||[];// Filter out movies that are already in trending to avoid duplicates\nconst trendingIds=new Set(trendingMovies.map(m=>m.id));const uniqueMovies=movies.filter(m=>!trendingIds.has(m.id));const featured=uniqueMovies.filter(m=>m.vote_average>=7).slice(0,6);setFeaturedMovies(featured);setAllMovies(uniqueMovies.slice(0,12));setTopRatedMovies([...uniqueMovies].sort((a,b)=>(b.vote_average||0)-(a.vote_average||0)).slice(0,12));localStorage.setItem(cacheKey,JSON.stringify({results:uniqueMovies}));}}).catch(e=>console.warn('Recommendations fetch failed:',e));}catch(e){console.warn('Priority fetch failed:',e);setLoading(false);}// PRIORITY 2: Background fetches (don't block UI)\n// Fetch user data\nif(userId){try{const[historyRes,watchlistRes]=await Promise.all([fetch(\"\".concat(API_BASE,\"/watch-history/\").concat(userId)),fetch(\"\".concat(API_BASE,\"/watchlist/\").concat(userId))]);if(historyRes.ok){const data=await historyRes.json();setWatchHistory(data.movies||data.history||[]);}if(watchlistRes.ok){const data=await watchlistRes.json();setWatchlist(data.movies||data.watchlist||[]);}}catch(e){console.warn('Failed to fetch user data:',e);}}// Fetch new releases\ntry{const newRes=await fetch(\"\".concat(API_BASE,\"/movies/new-releases?limit=24\"));if(newRes.ok){const data=await newRes.json();const movies=data.movies||[];// Filter out movies that are already in trending or featured to avoid duplicates\nconst existingIds=new Set([...trendingMovies,...featuredMovies].map(m=>m.id));const uniqueNew=movies.filter(m=>!existingIds.has(m.id)).slice(0,12);setNewMovies(uniqueNew);}}catch(e){console.warn('Failed to fetch new releases:',e);}};fetchMovies();},[]);if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"hero-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"hero-overlay\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"hero-title\",children:\"\\uD83C\\uDFAC Xem Phim Online Mi\\u1EC5n Ph\\xED\"}),/*#__PURE__*/_jsx(\"p\",{className:\"hero-subtitle\",children:\"Ch\\u1EA5t l\\u01B0\\u1EE3ng HD, c\\u1EADp nh\\u1EADt li\\xEAn t\\u1EE5c - H\\xE0ng ngh\\xECn b\\u1ED9 phim hay \\u0111ang ch\\u1EDD b\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"search-input\",placeholder:\"T\\xECm ki\\u1EBFm phim...\",value:searchQuery,onChange:e=>handleSearch(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"search-btn\",children:\"\\uD83D\\uDD0D\"})]})]})}),/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u0110ang t\\u1EA3i...\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid skeleton\",children:Array.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"movie-card skeleton-card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"movie-thumb skeleton-thumb\"})},i))})]})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"home-page\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"hero-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"hero-overlay\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"hero-title\",children:\"\\uD83C\\uDFAC Xem Phim Online Mi\\u1EC5n Ph\\xED\"}),/*#__PURE__*/_jsx(\"p\",{className:\"hero-subtitle\",children:\"Ch\\u1EA5t l\\u01B0\\u1EE3ng HD, c\\u1EADp nh\\u1EADt li\\xEAn t\\u1EE5c - H\\xE0ng ngh\\xECn b\\u1ED9 phim hay \\u0111ang ch\\u1EDD b\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"search-input\",placeholder:\"T\\xECm ki\\u1EBFm phim...\",value:searchQuery,onChange:e=>handleSearch(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"search-btn\",children:\"\\uD83D\\uDD0D\"})]})]})}),!isSearching&&/*#__PURE__*/_jsxs(\"div\",{className:\"filter-bar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"filter-group\",children:/*#__PURE__*/_jsxs(\"select\",{value:genreFilter,onChange:e=>setGenreFilter(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"T\\u1EA5t c\\u1EA3 th\\u1EC3 lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"option\",{value:\"action\",children:\"H\\xE0nh \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"comedy\",children:\"H\\xE0i\"}),/*#__PURE__*/_jsx(\"option\",{value:\"drama\",children:\"Ch\\xEDnh k\\u1ECBch\"}),/*#__PURE__*/_jsx(\"option\",{value:\"horror\",children:\"Kinh d\\u1ECB\"}),/*#__PURE__*/_jsx(\"option\",{value:\"romance\",children:\"L\\xE3ng m\\u1EA1n\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-group\",children:/*#__PURE__*/_jsxs(\"select\",{value:yearFilter,onChange:e=>setYearFilter(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"T\\u1EA5t c\\u1EA3 n\\u0103m\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2024\",children:\"2024\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2023\",children:\"2023\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2020-2022\",children:\"2020-2022\"}),/*#__PURE__*/_jsx(\"option\",{value:\"older\",children:\"Tr\\u01B0\\u1EDBc 2020\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"filter-group\",children:/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"rating\",children:\"\\u0110\\xE1nh gi\\xE1 cao\"}),/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"M\\u1EDBi nh\\u1EA5t\"}),/*#__PURE__*/_jsx(\"option\",{value:\"title\",children:\"T\\xEAn A-Z\"})]})})]}),isSearching&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"section-title\",children:[\"\\uD83D\\uDD0E K\\u1EBFt qu\\u1EA3 t\\xECm ki\\u1EBFm \\\"\",searchQuery,\"\\\"\"]})}),searchResults.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:searchResults.map((movie,idx)=>/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y phim\"})]}),!isSearching&&watchHistory.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD83D\\uDCFA Ti\\u1EBFp t\\u1EE5c xem\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:watchHistory.slice(0,12).map((entry,idx)=>{const movie=allMovies.find(m=>m.id===entry.movieId);return movie?/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx):null;})})]}),!isSearching&&watchlist.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u2764\\uFE0F Phim \\u0110\\xE3 L\\u01B0u\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:watchlist.slice(0,12).map((entry,idx)=>{const movie=allMovies.find(m=>m.id===entry.movieId);return movie?/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:true},idx):null;})})]}),!isSearching&&trendingMovies.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD83D\\uDD25 \\u0110ang Hot Nh\\u1EA5t\"})}),(()=>{const filtered=filterMovies(trendingMovies).slice(0,12);return filtered.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:filtered.map((movie,idx)=>/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y phim ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"});})()]}),!isSearching&&featuredMovies.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD83C\\uDFAF G\\u1EE3i \\xDD D\\xE0nh Ri\\xEAng Cho B\\u1EA1n\"})}),(()=>{const filtered=filterMovies(featuredMovies);return filtered.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:filtered.map((movie,idx)=>/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y phim ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"});})()]}),!isSearching&&newMovies.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD83C\\uDD95 Phim M\\u1EDBi C\\u1EADp Nh\\u1EADt\"})}),(()=>{const filtered=filterMovies(newMovies).slice(0,12);return filtered.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:filtered.map((movie,idx)=>/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y phim ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"});})()]}),!isSearching&&topRatedMovies.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"movie-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u2B50 \\u0110i\\u1EC3m Cao Nh\\u1EA5t\"})}),(()=>{const filtered=filterMovies(topRatedMovies).slice(0,12);return filtered.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:filtered.map((movie,idx)=>/*#__PURE__*/_jsx(MovieCard,{movie:movie,commentCounts:commentCounts,onClick:onMovieClick,onWatchlistClick:handleWatchlistClick,isInWatchlist:isMovieInWatchlist(movie.id)},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y phim ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"});})()]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","API_BASE","jsx","_jsx","jsxs","_jsxs","MovieCard","_ref","movie","commentCounts","onClick","onWatchlistClick","isInWatchlist","poster","poster_url","poster_path","className","children","src","alt","title","loading","year","vote_average","id","e","stopPropagation","concat","HomePage","_ref2","onMovieClick","allMovies","setAllMovies","setCommentCounts","featuredMovies","setFeaturedMovies","newMovies","setNewMovies","topRatedMovies","setTopRatedMovies","trendingMovies","setTrendingMovies","watchHistory","setWatchHistory","watchlist","setWatchlist","setLoading","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearching","setIsSearching","searchTimeoutRef","genreFilter","setGenreFilter","yearFilter","setYearFilter","sortBy","setSortBy","handleSearch","query","current","clearTimeout","trim","length","setTimeout","response","fetch","encodeURIComponent","ok","data","json","results","error","console","fetchCommentCounts","movies","ids","map","m","filter","Boolean","resp","method","headers","body","JSON","stringify","movie_ids","d","counts","prev","_objectSpread","handleWatchlistClick","_JSON$parse","storedUser","localStorage","getItem","userId","parse","some","w","movieId","movie_id","user_id","action","added_at","Date","toISOString","isMovieInWatchlist","genreMap","filterMovies","filtered","targetGenres","toLowerCase","genres","Array","isArray","genreNames","g","name","gn","tg","includes","warn","sort","a","b","localeCompare","fetchMovies","_JSON$parse2","cacheKey","cached","hasCached","parsed","featured","slice","trendingRes","movieIds","detailsPromises","then","r","catch","details","Promise","all","fullMovies","forEach","fm","idx","orig","interaction_count","recResp","trendingIds","Set","uniqueMovies","has","setItem","historyRes","watchlistRes","history","newRes","existingIds","uniqueNew","type","placeholder","value","onChange","target","from","_","i","entry","find"],"sources":["D:/cn/phim/frontend/src/pages/HomePage.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport './HomePage.css';\r\nimport { API_BASE } from '../config';\r\n\r\nfunction MovieCard({ movie, commentCounts, onClick, onWatchlistClick, isInWatchlist }) {\r\n  const poster = movie.poster_url || movie.poster_path || movie.poster;\r\n  return (\r\n    <div className=\"movie-card\" onClick={() => onClick && onClick(movie)}>\r\n      <div className=\"movie-thumb\">\r\n        {poster ? (\r\n          <img src={poster} alt={movie.title} loading=\"lazy\" />\r\n        ) : (\r\n          <div className=\"no-poster\">Kh√¥ng c√≥ poster</div>\r\n        )}\r\n        <div className=\"movie-overlay\">\r\n          <div className=\"overlay-content\">\r\n            <h3 className=\"movie-title\">{movie.title}</h3>\r\n            <div className=\"movie-meta\">\r\n              <span className=\"year\">{movie.year}</span>\r\n              <span className=\"rating\">‚≠ê {movie.vote_average || 'N/A'}</span>\r\n              <span className=\"comments\">üí¨ {commentCounts && (commentCounts[movie.id] || 0)}</span>\r\n            </div>\r\n            <div className=\"movie-actions\">\r\n              <button className=\"btn-play\" onClick={(e) => { e.stopPropagation(); onClick && onClick(movie); }}>\r\n                ‚ñ∂ Xem phim\r\n              </button>\r\n              <button \r\n                className={`btn-watchlist ${isInWatchlist ? 'active' : ''}`}\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  onWatchlistClick && onWatchlistClick(movie);\r\n                }}\r\n              >\r\n                {isInWatchlist ? '‚ù§Ô∏è' : 'ü§ç'} L∆∞u\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function HomePage({ onMovieClick }) {\r\n  const [allMovies, setAllMovies] = useState([]);\r\n  const [commentCounts, setCommentCounts] = useState({});\r\n  const [featuredMovies, setFeaturedMovies] = useState([]);\r\n  const [newMovies, setNewMovies] = useState([]);\r\n  const [topRatedMovies, setTopRatedMovies] = useState([]);\r\n  const [trendingMovies, setTrendingMovies] = useState([]);\r\n  const [watchHistory, setWatchHistory] = useState([]);\r\n  const [watchlist, setWatchlist] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const searchTimeoutRef = useRef(null);\r\n  \r\n  // Filter states\r\n  const [genreFilter, setGenreFilter] = useState('all');\r\n  const [yearFilter, setYearFilter] = useState('all');\r\n  const [sortBy, setSortBy] = useState('rating');\r\n\r\n  const handleSearch = async (query) => {\r\n    setSearchQuery(query);\r\n    if (searchTimeoutRef.current) {\r\n      clearTimeout(searchTimeoutRef.current);\r\n    }\r\n    if (query.trim().length > 0) {\r\n      searchTimeoutRef.current = setTimeout(async () => {\r\n        setIsSearching(true);\r\n        try {\r\n          const response = await fetch(`${API_BASE}/movies/autocomplete?q=${encodeURIComponent(query)}&n=12`);\r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            setSearchResults(data.results || []);\r\n          } else {\r\n            setSearchResults([]);\r\n          }\r\n        } catch (error) {\r\n          console.error('Search failed:', error);\r\n          setSearchResults([]);\r\n        }\r\n      }, 200);\r\n    } else {\r\n      setIsSearching(false);\r\n      setSearchResults([]);\r\n    }\r\n  };\r\n\r\n  const fetchCommentCounts = async (movies) => {\r\n    try {\r\n      const ids = movies.map(m => m.id).filter(Boolean);\r\n      if (!ids.length) return;\r\n      const resp = await fetch(`${API_BASE}/movies/comments/counts`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ movie_ids: ids }),\r\n      });\r\n      if (resp.ok) {\r\n        const d = await resp.json();\r\n        const counts = d.counts || d || {};\r\n        setCommentCounts(prev => ({ ...prev, ...counts }));\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to fetch comment counts:', e);\r\n    }\r\n  };\r\n\r\n  const handleWatchlistClick = async (movie) => {\r\n    const storedUser = localStorage.getItem('user');\r\n    const userId = storedUser ? JSON.parse(storedUser)?.userId : 'Anonymous';\r\n    const isInWatchlist = watchlist.some(w => w.movieId === movie.id);\r\n    \r\n    try {\r\n      const response = await fetch(`${API_BASE}/watchlist`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          movie_id: movie.id,\r\n          user_id: userId,\r\n          action: isInWatchlist ? 'remove' : 'add'\r\n        })\r\n      });\r\n      \r\n      if (response.ok) {\r\n        if (isInWatchlist) {\r\n          setWatchlist(prev => prev.filter(w => w.movieId !== movie.id));\r\n        } else {\r\n          setWatchlist(prev => [...prev, { movieId: movie.id, added_at: new Date().toISOString() }]);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to update watchlist:', error);\r\n    }\r\n  };\r\n\r\n  const isMovieInWatchlist = (movieId) => watchlist.some(w => w.movieId === movieId);\r\n\r\n  // Map Vietnamese genre names to English equivalents\r\n  const genreMap = {\r\n    'action': ['action', 'h√†nh ƒë·ªông'],\r\n    'comedy': ['comedy', 'h√†i'],\r\n    'drama': ['drama', 'ch√≠nh k·ªãch'],\r\n    'horror': ['horror', 'kinh d·ªã'],\r\n    'romance': ['romance', 'l√£ng m·∫°n']\r\n  };\r\n\r\n  const filterMovies = (movies) => {\r\n    let filtered = [...movies];\r\n    \r\n    // Genre filter - match both English and Vietnamese names\r\n    if (genreFilter !== 'all') {\r\n      const targetGenres = genreMap[genreFilter.toLowerCase()] || [genreFilter.toLowerCase()];\r\n      filtered = filtered.filter(m => {\r\n        try {\r\n          let genres = m.genres;\r\n          if (typeof genres === 'string') {\r\n            genres = JSON.parse(genres);\r\n          }\r\n          if (Array.isArray(genres)) {\r\n            const genreNames = genres.map(g => {\r\n              if (typeof g === 'string') return g.toLowerCase();\r\n              if (g.name) return g.name.toLowerCase();\r\n              return '';\r\n            });\r\n            // Check if any genre name matches any target genre\r\n            return genreNames.some(gn => \r\n              targetGenres.some(tg => gn.includes(tg) || tg.includes(gn))\r\n            );\r\n          }\r\n          return false;\r\n        } catch (e) {\r\n          console.warn('Genre parse error:', e);\r\n          return false;\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Year filter\r\n    if (yearFilter !== 'all') {\r\n      if (yearFilter === '2024') {\r\n        filtered = filtered.filter(m => m.year >= 2024);\r\n      } else if (yearFilter === '2023') {\r\n        filtered = filtered.filter(m => m.year === 2023);\r\n      } else if (yearFilter === '2020-2022') {\r\n        filtered = filtered.filter(m => m.year >= 2020 && m.year <= 2022);\r\n      } else if (yearFilter === 'older') {\r\n        filtered = filtered.filter(m => m.year < 2020);\r\n      }\r\n    }\r\n    \r\n    // Sorting\r\n    if (sortBy === 'rating') {\r\n      filtered.sort((a, b) => (b.vote_average || 0) - (a.vote_average || 0));\r\n    } else if (sortBy === 'newest') {\r\n      filtered.sort((a, b) => (b.year || 0) - (a.year || 0));\r\n    } else if (sortBy === 'title') {\r\n      filtered.sort((a, b) => (a.title || '').localeCompare(b.title || ''));\r\n    }\r\n    \r\n    return filtered;\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchMovies = async () => {\r\n      const storedUser = localStorage.getItem('user');\r\n      const userId = storedUser ? JSON.parse(storedUser)?.userId : null;\r\n      \r\n      // PRIORITY 1: Fetch essential data for quick display (trending + featured)\r\n      try {\r\n        // Try cache first for featured/recommendations\r\n        const cacheKey = `cached_recs_collaborative_${userId || 'public'}`;\r\n        const cached = localStorage.getItem(cacheKey);\r\n        let hasCached = false;\r\n        if (cached) {\r\n          try {\r\n            const parsed = JSON.parse(cached);\r\n            const movies = parsed.results || [];\r\n            if (movies.length > 0) {\r\n              const featured = movies.filter(m => m.vote_average >= 7).slice(0, 6);\r\n              setFeaturedMovies(featured);\r\n              setAllMovies(movies);\r\n              setTopRatedMovies([...movies].sort((a, b) => (b.vote_average || 0) - (a.vote_average || 0)).slice(0, 12));\r\n              hasCached = true;\r\n            }\r\n          } catch (e) {}\r\n        }\r\n\r\n        // Fetch trending in parallel (most important)\r\n        const trendingRes = await fetch(`${API_BASE}/movies/trending?limit=12`);\r\n        if (trendingRes.ok) {\r\n          const data = await trendingRes.json();\r\n          let movies = data.movies || [];\r\n          \r\n          // If we got movieIds only, fetch full details for first 6 (visible ones)\r\n          if (movies.length > 0 && !movies[0].title) {\r\n            const movieIds = movies.slice(0, 6).map(m => m.movieId || m.id).filter(Boolean);\r\n            if (movieIds.length > 0) {\r\n              try {\r\n                const detailsPromises = movieIds.map(id => \r\n                  fetch(`${API_BASE}/movies/${id}`).then(r => r.ok ? r.json() : null).catch(() => null)\r\n                );\r\n                const details = await Promise.all(detailsPromises);\r\n                const fullMovies = details.filter(Boolean);\r\n                if (fullMovies.length > 0) {\r\n                  // Add interaction counts to full movies\r\n                  fullMovies.forEach((fm, idx) => {\r\n                    const orig = movies[idx];\r\n                    if (orig && orig.interaction_count) {\r\n                      fm.interaction_count = orig.interaction_count;\r\n                    }\r\n                  });\r\n                  movies = fullMovies;\r\n                }\r\n              } catch (e) {\r\n                console.warn('Failed to fetch movie details:', e);\r\n              }\r\n            }\r\n          }\r\n          \r\n          setTrendingMovies(movies);\r\n        }\r\n\r\n        // SET LOADING FALSE EARLY - show UI now instead of waiting for recommendations\r\n        setLoading(false);\r\n\r\n        // Fetch featured recommendations (in background, async, don't wait)\r\n        fetch(`${API_BASE}/recommendations?rec_type=collaborative&n=24`)\r\n          .then(recResp => {\r\n            if (recResp.ok) {\r\n              return recResp.json();\r\n            }\r\n            return null;\r\n          })\r\n          .then(data => {\r\n            if (data) {\r\n              const movies = data.results || [];\r\n              \r\n              // Filter out movies that are already in trending to avoid duplicates\r\n              const trendingIds = new Set(trendingMovies.map(m => m.id));\r\n              const uniqueMovies = movies.filter(m => !trendingIds.has(m.id));\r\n              \r\n              const featured = uniqueMovies.filter(m => m.vote_average >= 7).slice(0, 6);\r\n              setFeaturedMovies(featured);\r\n              setAllMovies(uniqueMovies.slice(0, 12));\r\n              setTopRatedMovies([...uniqueMovies].sort((a, b) => (b.vote_average || 0) - (a.vote_average || 0)).slice(0, 12));\r\n              localStorage.setItem(cacheKey, JSON.stringify({ results: uniqueMovies }));\r\n            }\r\n          })\r\n          .catch(e => console.warn('Recommendations fetch failed:', e));\r\n      } catch (e) {\r\n        console.warn('Priority fetch failed:', e);\r\n        setLoading(false);\r\n      }\r\n\r\n      // PRIORITY 2: Background fetches (don't block UI)\r\n      // Fetch user data\r\n      if (userId) {\r\n        try {\r\n          const [historyRes, watchlistRes] = await Promise.all([\r\n            fetch(`${API_BASE}/watch-history/${userId}`),\r\n            fetch(`${API_BASE}/watchlist/${userId}`)\r\n          ]);\r\n          \r\n          if (historyRes.ok) {\r\n            const data = await historyRes.json();\r\n            setWatchHistory(data.movies || data.history || []);\r\n          }\r\n          if (watchlistRes.ok) {\r\n            const data = await watchlistRes.json();\r\n            setWatchlist(data.movies || data.watchlist || []);\r\n          }\r\n        } catch (e) {\r\n          console.warn('Failed to fetch user data:', e);\r\n        }\r\n      }\r\n\r\n      // Fetch new releases\r\n      try {\r\n        const newRes = await fetch(`${API_BASE}/movies/new-releases?limit=24`);\r\n        if (newRes.ok) {\r\n          const data = await newRes.json();\r\n          const movies = data.movies || [];\r\n          \r\n          // Filter out movies that are already in trending or featured to avoid duplicates\r\n          const existingIds = new Set([...trendingMovies, ...featuredMovies].map(m => m.id));\r\n          const uniqueNew = movies.filter(m => !existingIds.has(m.id)).slice(0, 12);\r\n          setNewMovies(uniqueNew);\r\n        }\r\n      } catch (e) {\r\n        console.warn('Failed to fetch new releases:', e);\r\n      }\r\n    };\r\n\r\n    fetchMovies();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"home-page\">\r\n        <section className=\"hero-section\">\r\n          <div className=\"hero-overlay\">\r\n            <h1 className=\"hero-title\">üé¨ Xem Phim Online Mi·ªÖn Ph√≠</h1>\r\n            <p className=\"hero-subtitle\">Ch·∫•t l∆∞·ª£ng HD, c·∫≠p nh·∫≠t li√™n t·ª•c - H√†ng ngh√¨n b·ªô phim hay ƒëang ch·ªù b·∫°n</p>\r\n            <div className=\"search-container\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"search-input\"\r\n                placeholder=\"T√¨m ki·∫øm phim...\"\r\n                value={searchQuery}\r\n                onChange={(e) => handleSearch(e.target.value)}\r\n              />\r\n              <button className=\"search-btn\">üîç</button>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">ƒêang t·∫£i...</h2>\r\n          </div>\r\n          <div className=\"movie-grid skeleton\">\r\n            {Array.from({ length: 8 }).map((_, i) => (\r\n              <div className=\"movie-card skeleton-card\" key={i}>\r\n                <div className=\"movie-thumb skeleton-thumb\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </section>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"home-page\">\r\n      {/* Hero Section */}\r\n      <section className=\"hero-section\">\r\n        <div className=\"hero-overlay\">\r\n          <h1 className=\"hero-title\">üé¨ Xem Phim Online Mi·ªÖn Ph√≠</h1>\r\n          <p className=\"hero-subtitle\">Ch·∫•t l∆∞·ª£ng HD, c·∫≠p nh·∫≠t li√™n t·ª•c - H√†ng ngh√¨n b·ªô phim hay ƒëang ch·ªù b·∫°n</p>\r\n          <div className=\"search-container\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"search-input\"\r\n              placeholder=\"T√¨m ki·∫øm phim...\"\r\n              value={searchQuery}\r\n              onChange={(e) => handleSearch(e.target.value)}\r\n            />\r\n            <button className=\"search-btn\">üîç</button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Filter Bar */}\r\n      {!isSearching && (\r\n        <div className=\"filter-bar\">\r\n          <div className=\"filter-group\">\r\n            <select value={genreFilter} onChange={(e) => setGenreFilter(e.target.value)} className=\"filter-select\">\r\n              <option value=\"all\">T·∫•t c·∫£ th·ªÉ lo·∫°i</option>\r\n              <option value=\"action\">H√†nh ƒë·ªông</option>\r\n              <option value=\"comedy\">H√†i</option>\r\n              <option value=\"drama\">Ch√≠nh k·ªãch</option>\r\n              <option value=\"horror\">Kinh d·ªã</option>\r\n              <option value=\"romance\">L√£ng m·∫°n</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"filter-group\">\r\n            <select value={yearFilter} onChange={(e) => setYearFilter(e.target.value)} className=\"filter-select\">\r\n              <option value=\"all\">T·∫•t c·∫£ nƒÉm</option>\r\n              <option value=\"2024\">2024</option>\r\n              <option value=\"2023\">2023</option>\r\n              <option value=\"2020-2022\">2020-2022</option>\r\n              <option value=\"older\">Tr∆∞·ªõc 2020</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"filter-group\">\r\n            <select value={sortBy} onChange={(e) => setSortBy(e.target.value)} className=\"filter-select\">\r\n              <option value=\"rating\">ƒê√°nh gi√° cao</option>\r\n              <option value=\"newest\">M·ªõi nh·∫•t</option>\r\n              <option value=\"title\">T√™n A-Z</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search Results */}\r\n      {isSearching && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">üîé K·∫øt qu·∫£ t√¨m ki·∫øm \"{searchQuery}\"</h2>\r\n          </div>\r\n          {searchResults.length > 0 ? (\r\n            <div className=\"movie-grid\">\r\n              {searchResults.map((movie, idx) => (\r\n                <MovieCard \r\n                  key={idx} \r\n                  movie={movie} \r\n                  commentCounts={commentCounts} \r\n                  onClick={onMovieClick}\r\n                  onWatchlistClick={handleWatchlistClick}\r\n                  isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"no-results\">Kh√¥ng t√¨m th·∫•y phim</div>\r\n          )}\r\n        </section>\r\n      )}\r\n\r\n      {/* Watch History */}\r\n      {!isSearching && watchHistory.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">üì∫ Ti·∫øp t·ª•c xem</h2>\r\n          </div>\r\n          <div className=\"movie-grid\">\r\n            {watchHistory.slice(0, 12).map((entry, idx) => {\r\n              const movie = allMovies.find(m => m.id === entry.movieId);\r\n              return movie ? (\r\n                <MovieCard \r\n                  key={idx} \r\n                  movie={movie} \r\n                  commentCounts={commentCounts} \r\n                  onClick={onMovieClick}\r\n                  onWatchlistClick={handleWatchlistClick}\r\n                  isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                />\r\n              ) : null;\r\n            })}\r\n          </div>\r\n        </section>\r\n      )}\r\n\r\n      {/* Watchlist */}\r\n      {!isSearching && watchlist.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">‚ù§Ô∏è Phim ƒê√£ L∆∞u</h2>\r\n          </div>\r\n          <div className=\"movie-grid\">\r\n            {watchlist.slice(0, 12).map((entry, idx) => {\r\n              const movie = allMovies.find(m => m.id === entry.movieId);\r\n              return movie ? (\r\n                <MovieCard \r\n                  key={idx} \r\n                  movie={movie} \r\n                  commentCounts={commentCounts} \r\n                  onClick={onMovieClick}\r\n                  onWatchlistClick={handleWatchlistClick}\r\n                  isInWatchlist={true}\r\n                />\r\n              ) : null;\r\n            })}\r\n          </div>\r\n        </section>\r\n      )}\r\n\r\n      {/* Trending */}\r\n      {!isSearching && trendingMovies.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">üî• ƒêang Hot Nh·∫•t</h2>\r\n          </div>\r\n          {(() => {\r\n            const filtered = filterMovies(trendingMovies).slice(0, 12);\r\n            return filtered.length > 0 ? (\r\n              <div className=\"movie-grid\">\r\n                {filtered.map((movie, idx) => (\r\n                  <MovieCard \r\n                    key={idx} \r\n                    movie={movie} \r\n                    commentCounts={commentCounts} \r\n                    onClick={onMovieClick}\r\n                    onWatchlistClick={handleWatchlistClick}\r\n                    isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"no-results\">Kh√¥ng t√¨m th·∫•y phim ph√π h·ª£p v·ªõi b·ªô l·ªçc</div>\r\n            );\r\n          })()}\r\n        </section>\r\n      )}\r\n\r\n      {/* Featured/Recommendations */}\r\n      {!isSearching && featuredMovies.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">üéØ G·ª£i √ù D√†nh Ri√™ng Cho B·∫°n</h2>\r\n          </div>\r\n          {(() => {\r\n            const filtered = filterMovies(featuredMovies);\r\n            return filtered.length > 0 ? (\r\n              <div className=\"movie-grid\">\r\n                {filtered.map((movie, idx) => (\r\n                  <MovieCard \r\n                    key={idx} \r\n                    movie={movie} \r\n                    commentCounts={commentCounts} \r\n                    onClick={onMovieClick}\r\n                    onWatchlistClick={handleWatchlistClick}\r\n                    isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"no-results\">Kh√¥ng t√¨m th·∫•y phim ph√π h·ª£p v·ªõi b·ªô l·ªçc</div>\r\n            );\r\n          })()}\r\n        </section>\r\n      )}\r\n\r\n      {/* New Releases */}\r\n      {!isSearching && newMovies.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">üÜï Phim M·ªõi C·∫≠p Nh·∫≠t</h2>\r\n          </div>\r\n          {(() => {\r\n            const filtered = filterMovies(newMovies).slice(0, 12);\r\n            return filtered.length > 0 ? (\r\n              <div className=\"movie-grid\">\r\n                {filtered.map((movie, idx) => (\r\n                  <MovieCard \r\n                    key={idx} \r\n                    movie={movie} \r\n                    commentCounts={commentCounts} \r\n                    onClick={onMovieClick}\r\n                    onWatchlistClick={handleWatchlistClick}\r\n                    isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"no-results\">Kh√¥ng t√¨m th·∫•y phim ph√π h·ª£p v·ªõi b·ªô l·ªçc</div>\r\n            );\r\n          })()}\r\n        </section>\r\n      )}\r\n\r\n      {/* Top Rated */}\r\n      {!isSearching && topRatedMovies.length > 0 && (\r\n        <section className=\"movie-section\">\r\n          <div className=\"section-header\">\r\n            <h2 className=\"section-title\">‚≠ê ƒêi·ªÉm Cao Nh·∫•t</h2>\r\n          </div>\r\n          {(() => {\r\n            const filtered = filterMovies(topRatedMovies).slice(0, 12);\r\n            return filtered.length > 0 ? (\r\n              <div className=\"movie-grid\">\r\n                {filtered.map((movie, idx) => (\r\n                  <MovieCard \r\n                    key={idx} \r\n                    movie={movie} \r\n                    commentCounts={commentCounts} \r\n                    onClick={onMovieClick}\r\n                    onWatchlistClick={handleWatchlistClick}\r\n                    isInWatchlist={isMovieInWatchlist(movie.id)}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"no-results\">Kh√¥ng t√¨m th·∫•y phim ph√π h·ª£p v·ªõi b·ªô l·ªçc</div>\r\n            );\r\n          })()}\r\n        </section>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}