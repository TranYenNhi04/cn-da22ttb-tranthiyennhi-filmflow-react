{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./App.css';import AuthPage from'./pages/AuthPage';import HomePage from'./pages/HomePage';import RecommendationsPage from'./pages/RecommendationsPage';import ProfilePage from'./pages/ProfilePage';import CollectionsPage from'./pages/CollectionsPage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[currentPage,setCurrentPage]=useState('home');const[pageHistory,setPageHistory]=useState(['home']);const[user,setUser]=useState(null);const[selectedMovie,setSelectedMovie]=useState(null);useEffect(()=>{// Check if user is logged in\nconst storedUser=localStorage.getItem('user');if(storedUser){const u=JSON.parse(storedUser);// ensure userId exists\nif(!u.userId){u.userId=\"user_\".concat(Date.now(),\"_\").concat(Math.random().toString(36).slice(2,9));localStorage.setItem('user',JSON.stringify(u));// best-effort notify backend\ntry{fetch(\"\".concat(process.env.REACT_APP_API_BASE||'http://localhost:8000',\"/users\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:u.userId,metadata:JSON.stringify({name:u.name,email:u.email})})}).catch(()=>{});}catch(e){}}setUser(u);setIsAuthenticated(true);}},[]);const handleLogin=()=>{const storedUser=localStorage.getItem('user');if(storedUser){setUser(JSON.parse(storedUser));setIsAuthenticated(true);}};const handleLogout=()=>{localStorage.removeItem('user');setUser(null);setIsAuthenticated(false);setCurrentPage('home');setPageHistory(['home']);};const navigateTo=page=>{setPageHistory([...pageHistory,page]);setCurrentPage(page);};const handleMovieClick=movie=>{setSelectedMovie(movie);navigateTo('watch');};const goBack=()=>{if(pageHistory.length>1){const newHistory=[...pageHistory];newHistory.pop();// Remove current page\nconst previousPage=newHistory[newHistory.length-1];setPageHistory(newHistory);setCurrentPage(previousPage);if(previousPage!=='watch'){setSelectedMovie(null);}}};if(!isAuthenticated){return/*#__PURE__*/_jsx(AuthPage,{onLogin:handleLogin});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-header\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"brand-text\",children:\"FilmFlow\"})}),/*#__PURE__*/_jsxs(\"nav\",{className:\"sidebar-nav\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(currentPage==='home'?'active':''),onClick:()=>navigateTo('home'),children:\"\\uD83C\\uDFE0 Trang ch\\u1EE7\"}),/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(currentPage==='recommendations'?'active':''),onClick:()=>navigateTo('recommendations'),children:\"\\u2B50 G\\u1EE3i \\xFD\"}),/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(currentPage==='collections'?'active':''),onClick:()=>navigateTo('collections'),children:\"\\uD83D\\uDCDA B\\u1ED9 S\\u01B0u T\\u1EADp\"}),/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(currentPage==='profile'?'active':''),onClick:()=>navigateTo('profile'),children:\"\\uD83D\\uDC64 H\\u1ED3 S\\u01A1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-footer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-info\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDC64 \",(user===null||user===void 0?void 0:user.name)||(user===null||user===void 0?void 0:user.email)]})}),/*#__PURE__*/_jsx(\"button\",{className:\"nav-link logout-btn\",onClick:handleLogout,children:\"\\uD83D\\uDEAA \\u0110\\u0103ng xu\\u1EA5t\"})]})]})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"main-content\",children:[currentPage==='home'&&/*#__PURE__*/_jsx(HomePage,{onMovieClick:handleMovieClick}),currentPage==='recommendations'&&/*#__PURE__*/_jsx(RecommendationsPage,{onBack:goBack}),currentPage==='collections'&&/*#__PURE__*/_jsx(CollectionsPage,{onMovieClick:handleMovieClick}),currentPage==='profile'&&/*#__PURE__*/_jsx(ProfilePage,{}),currentPage==='watch'&&/*#__PURE__*/_jsx(RecommendationsPage,{onBack:goBack,initialMovie:selectedMovie})]})]});}","map":{"version":3,"names":["React","useState","useEffect","AuthPage","HomePage","RecommendationsPage","ProfilePage","CollectionsPage","jsx","_jsx","jsxs","_jsxs","App","isAuthenticated","setIsAuthenticated","currentPage","setCurrentPage","pageHistory","setPageHistory","user","setUser","selectedMovie","setSelectedMovie","storedUser","localStorage","getItem","u","JSON","parse","userId","concat","Date","now","Math","random","toString","slice","setItem","stringify","fetch","process","env","REACT_APP_API_BASE","method","headers","body","metadata","name","email","catch","e","handleLogin","handleLogout","removeItem","navigateTo","page","handleMovieClick","movie","goBack","length","newHistory","pop","previousPage","onLogin","className","children","onClick","onMovieClick","onBack","initialMovie"],"sources":["D:/cn/phim/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './App.css';\r\nimport AuthPage from './pages/AuthPage';\r\nimport HomePage from './pages/HomePage';\r\nimport RecommendationsPage from './pages/RecommendationsPage';\r\nimport ProfilePage from './pages/ProfilePage';\r\nimport CollectionsPage from './pages/CollectionsPage';\r\n\r\nexport default function App() {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState('home');\r\n  const [pageHistory, setPageHistory] = useState(['home']);\r\n  const [user, setUser] = useState(null);\r\n  const [selectedMovie, setSelectedMovie] = useState(null);\r\n\r\n  useEffect(() => {\r\n    // Check if user is logged in\r\n    const storedUser = localStorage.getItem('user');\r\n    if (storedUser) {\r\n      const u = JSON.parse(storedUser);\r\n      // ensure userId exists\r\n      if (!u.userId) {\r\n        u.userId = `user_${Date.now()}_${Math.random().toString(36).slice(2,9)}`;\r\n        localStorage.setItem('user', JSON.stringify(u));\r\n        // best-effort notify backend\r\n        try { fetch(`${process.env.REACT_APP_API_BASE || 'http://localhost:8000'}/users`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ userId: u.userId, metadata: JSON.stringify({ name: u.name, email: u.email }) }) }).catch(()=>{}); } catch(e){}\r\n      }\r\n      setUser(u);\r\n      setIsAuthenticated(true);\r\n    }\r\n  }, []);\r\n\r\n  const handleLogin = () => {\r\n    const storedUser = localStorage.getItem('user');\r\n    if (storedUser) {\r\n      setUser(JSON.parse(storedUser));\r\n      setIsAuthenticated(true);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('user');\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n    setCurrentPage('home');\r\n    setPageHistory(['home']);\r\n  };\r\n\r\n  const navigateTo = (page) => {\r\n    setPageHistory([...pageHistory, page]);\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  const handleMovieClick = (movie) => {\r\n    setSelectedMovie(movie);\r\n    navigateTo('watch');\r\n  };\r\n\r\n  const goBack = () => {\r\n    if (pageHistory.length > 1) {\r\n      const newHistory = [...pageHistory];\r\n      newHistory.pop(); // Remove current page\r\n      const previousPage = newHistory[newHistory.length - 1];\r\n      setPageHistory(newHistory);\r\n      setCurrentPage(previousPage);\r\n      if (previousPage !== 'watch') {\r\n        setSelectedMovie(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return <AuthPage onLogin={handleLogin} />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"app-container\">\r\n      <aside className=\"sidebar\">\r\n        <div className=\"sidebar-header\">\r\n          <h1 className=\"brand-text\">FilmFlow</h1>\r\n        </div>\r\n        <nav className=\"sidebar-nav\">\r\n          <button \r\n            className={`nav-link ${currentPage === 'home' ? 'active' : ''}`}\r\n            onClick={() => navigateTo('home')}\r\n          >\r\n            üè† Trang ch·ªß\r\n          </button>\r\n          <button \r\n            className={`nav-link ${currentPage === 'recommendations' ? 'active' : ''}`}\r\n            onClick={() => navigateTo('recommendations')}\r\n          >\r\n            ‚≠ê G·ª£i √Ω\r\n          </button>\r\n          <button \r\n            className={`nav-link ${currentPage === 'collections' ? 'active' : ''}`}\r\n            onClick={() => navigateTo('collections')}\r\n          >\r\n            üìö B·ªô S∆∞u T·∫≠p\r\n          </button>\r\n          <button \r\n            className={`nav-link ${currentPage === 'profile' ? 'active' : ''}`}\r\n            onClick={() => navigateTo('profile')}\r\n          >\r\n            üë§ H·ªì S∆°\r\n          </button>\r\n          <div className=\"sidebar-footer\">\r\n            <div className=\"user-info\">\r\n              <span>üë§ {user?.name || user?.email}</span>\r\n            </div>\r\n            <button className=\"nav-link logout-btn\" onClick={handleLogout}>\r\n              üö™ ƒêƒÉng xu·∫•t\r\n            </button>\r\n          </div>\r\n        </nav>\r\n      </aside>\r\n\r\n      <main className=\"main-content\">\r\n        {currentPage === 'home' && <HomePage onMovieClick={handleMovieClick} />}\r\n        {currentPage === 'recommendations' && <RecommendationsPage onBack={goBack} />}\r\n        {currentPage === 'collections' && <CollectionsPage onMovieClick={handleMovieClick} />}\r\n        {currentPage === 'profile' && <ProfilePage />}\r\n        {currentPage === 'watch' && <RecommendationsPage onBack={goBack} initialMovie={selectedMovie} />}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}